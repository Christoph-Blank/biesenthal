(window.webpackJsonp=window.webpackJsonp||[]).push([[271,246,256,258,262,263,264,265,266,267,268,269,270],{1100:function(e,t,r){"use strict";var u=r(11),i=r(76),y=r(54),c=r(7),a=r(13),m=r(1),n=r(52),v=r(9),s=r(42),o=r(91),l=r(17),f=r(152),h=r(285);function d(e){return e.feature?e.feature:e.element?e.element:void 0}var p=function(o){function e(e){var t=e||{},r=t;r.handleDownEvent||(r.handleDownEvent=n.b),r.stopDown||(r.stopDown=n.a),o.call(this,r),this.source_=t.source?t.source:null,this.vertex_=void 0===t.vertex||t.vertex,this.edge_=void 0===t.edge||t.edge,this.features_=t.features?t.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelCoordinate_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.sortByDistance_=function(e,t){var r=Object(y.i)(this.pixelCoordinate_,e.segment),n=Object(y.i)(this.pixelCoordinate_,t.segment);return r-n}.bind(this),this.rBush_=new h.a,this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,Circle:this.writeCircleGeometry_}}return o&&(e.__proto__=o),((e.prototype=Object.create(o&&o.prototype)).constructor=e).prototype.addFeature=function(e,t){var r=void 0===t||t,n=Object(u.c)(e),o=e.getGeometry();if(o){var i=this.SEGMENT_WRITERS_[o.getType()];i&&(this.indexedFeaturesExtents_[n]=o.getExtent(Object(m.j)()),i.call(this,e,o))}r&&(this.featureChangeListenerKeys_[n]=Object(c.a)(e,a.a.CHANGE,this.handleFeatureChange_,this))},e.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},e.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},e.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},e.prototype.handleEvent=function(e){var t=this.snapTo(e.pixel,e.coordinate,e.map);return t.snapped&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),o.prototype.handleEvent.call(this,e)},e.prototype.handleFeatureAdd_=function(e){var t=d(e);this.addFeature(t)},e.prototype.handleFeatureRemove_=function(e){var t=d(e);this.removeFeature(t)},e.prototype.handleFeatureChange_=function(e){var t=e.target;if(this.handlingDownUpSequence){var r=Object(u.c)(t);r in this.pendingFeatures_||(this.pendingFeatures_[r]=t)}else this.updateFeature_(t)},e.prototype.handleUpEvent=function(){var e=Object(l.c)(this.pendingFeatures_);return e.length&&(e.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},e.prototype.removeFeature=function(t,e){var r=void 0===e||e,n=Object(u.c)(t),o=this.indexedFeaturesExtents_[n];if(o){var i=this.rBush_,a=[];i.forEachInExtent(o,function(e){t===e.feature&&a.push(e)});for(var s=a.length-1;0<=s;--s)i.remove(a[s])}r&&(Object(c.e)(this.featureChangeListenerKeys_[n]),delete this.featureChangeListenerKeys_[n])},e.prototype.setMap=function(e){var t=this.getMap(),r=this.featuresListenerKeys_,n=this.getFeatures_();t&&(r.forEach(c.e),r.length=0,n.forEach(this.forEachFeatureRemove_.bind(this))),o.prototype.setMap.call(this,e),e&&(this.features_?r.push(Object(c.a)(this.features_,i.a.ADD,this.handleFeatureAdd_,this),Object(c.a)(this.features_,i.a.REMOVE,this.handleFeatureRemove_,this)):this.source_&&r.push(Object(c.a)(this.source_,f.a.ADDFEATURE,this.handleFeatureAdd_,this),Object(c.a)(this.source_,f.a.REMOVEFEATURE,this.handleFeatureRemove_,this)),n.forEach(this.forEachFeatureAdd_.bind(this)))},e.prototype.snapTo=function(e,t,r){var n=r.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),o=r.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),i=Object(m.b)([n,o]),a=this.rBush_.getInExtent(i);this.vertex_&&!this.edge_&&(a=a.filter(function(e){return e.feature.getGeometry().getType()!==v.a.CIRCLE}));var s,u,c,l,f=!1,h=null,d=null;if(0<a.length){this.pixelCoordinate_=t,a.sort(this.sortByDistance_);var p=a[0].segment,g=a[0].feature.getGeometry().getType()===v.a.CIRCLE;this.vertex_&&!this.edge_?(s=r.getPixelFromCoordinate(p[0]),u=r.getPixelFromCoordinate(p[1]),c=Object(y.h)(e,s),l=Object(y.h)(e,u),Math.sqrt(Math.min(c,l))<=this.pixelTolerance_&&(f=!0,h=l<c?p[1]:p[0],d=r.getPixelFromCoordinate(h))):this.edge_&&(h=g?Object(y.b)(t,a[0].feature.getGeometry()):Object(y.c)(t,p),d=r.getPixelFromCoordinate(h),Object(y.d)(e,d)<=this.pixelTolerance_&&(f=!0,this.vertex_&&!g&&(s=r.getPixelFromCoordinate(p[0]),u=r.getPixelFromCoordinate(p[1]),c=Object(y.h)(d,s),l=Object(y.h)(d,u),Math.sqrt(Math.min(c,l))<=this.pixelTolerance_&&(h=l<c?p[1]:p[0],d=r.getPixelFromCoordinate(h))))),f&&(d=[Math.round(d[0]),Math.round(d[1])])}return{snapped:f,vertex:h,vertexPixel:d}},e.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},e.prototype.writeCircleGeometry_=function(e,t){for(var r=Object(s.c)(t).getCoordinates()[0],n=0,o=r.length-1;n<o;++n){var i=r.slice(n,n+2),a={feature:e,segment:i};this.rBush_.insert(Object(m.b)(i),a)}},e.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),n=0;n<r.length;++n){var o=this.SEGMENT_WRITERS_[r[n].getType()];o&&o.call(this,e,r[n])}},e.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length-1;n<o;++n){var i=r.slice(n,n+2),a={feature:e,segment:i};this.rBush_.insert(Object(m.b)(i),a)}},e.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,s=i.length-1;a<s;++a){var u=i.slice(a,a+2),c={feature:e,segment:u};this.rBush_.insert(Object(m.b)(u),c)}},e.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n){var i=r[n],a={feature:e,segment:[i,i]};this.rBush_.insert(t.getExtent(),a)}},e.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,s=i.length;a<s;++a)for(var u=i[a],c=0,l=u.length-1;c<l;++c){var f=u.slice(c,c+2),h={feature:e,segment:f};this.rBush_.insert(Object(m.b)(f),h)}},e.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),n={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),n)},e.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,s=i.length-1;a<s;++a){var u=i.slice(a,a+2),c={feature:e,segment:u};this.rBush_.insert(Object(m.b)(u),c)}},e}(o.b);t.a=p},1799:function(e,t,r){"use strict";r.r(t);var n=r(41);t.default=new n.a},1800:function(e,o,i){"use strict";i.r(o),function(t){i.d(o,"transformCoordinatesLocalToWgs84Projection",function(){return e}),i.d(o,"transformCoordinatesWgs84ToLocalProjection",function(){return n});var r=i(55);function e(e){return Object(r.e)(t.request("MapView","getProjection").getCode(),"EPSG:4326",e)}function n(e){return Object(r.e)("EPSG:4326",t.request("MapView","getProjection").getCode(),e)}}.call(this,i(4))},1823:function(e,t,r){"use strict";r.r(t);var n=r(41);t.default=new n.a},1828:function(e,t,c){"use strict";c.r(t),function(r){c.d(t,"default",function(){return e});var n=c(23),o=c(37),i=c(34);function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u=null;function e(e){u=u||r.request("Reachability","getSettings").isochrones.styleAreas;var t=e.get("color");return new n.c({fill:new o.a({color:[].concat(a(t),[u.opacity])}),stroke:new i.a({color:u.lineColor,width:u.lineWidth})})}}.call(this,c(4))},1838:function(e,t,r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,"default",function(){return n});var n=function(){function n(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.lat=e,this.lng=t,this.displayName=r,this.coordinates=[]}var e,t,r;return e=n,(t=[{key:"getLat",value:function(){return this.lat}},{key:"setLat",value:function(e){this.lat=e}},{key:"getLng",value:function(){return this.lng}},{key:"setLng",value:function(e){this.lng=e}},{key:"getDisplayName",value:function(){return this.displayName}},{key:"setDisplayName",value:function(e){this.displayName=e}},{key:"getCoordinates",value:function(){return this.coordinates}},{key:"setCoordinates",value:function(e){this.coordinates=e}}])&&o(e.prototype,t),r&&o(e,r),n}()},1839:function(e,c,l){"use strict";l.r(c),function(e){l.d(c,"default",function(){return u});var t=l(23),r=l(78),n=l(34),o=l(37);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s=null;function u(){return s=s||e.request("Reachability","getSettings").isochrones.styleStartingPoint,new t.c({image:new r.a({radius:s.radius,stroke:new n.a({color:[].concat(i(s.lineColor),[1]),width:s.lineWidth}),fill:new o.a({color:[].concat(i(s.fillColor),[s.opacity])})})})}}.call(this,l(4))},1853:function(e,c,l){"use strict";l.r(c),function(f,h){l.d(c,"fetchCoordinatesByText",function(){return r}),l.d(c,"fetchTextByCoordinates",function(){return a}),l.d(c,"fetchSuggestionsByText",function(){return o});var e=l(195),d=l.n(e),p=l(1800),g=l(1838);function u(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function t(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function o(e){u(n,t,r,o,i,"next",e)}function i(e){u(n,t,r,o,i,"throw",e)}o(void 0)})}}function r(e){return n.apply(this,arguments)}function n(){return(n=t(regeneratorRuntime.mark(function e(t){var r,n,o,i,a,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.search,n=f.request("Reachability","getSettings").geosearch,o=[],r.length<n.minChars)return e.abrupt("return",o);e.next=5;break;case 5:return e.prev=5,i=n.serviceId,a=f.request("RestReader","getServiceById",i).get("url"),s="".concat(a,"?count=").concat(n.limit,"&properties=text"),u="&query=".concat(encodeURIComponent(r)),e.next=12,d.a.get(s+u);case 12:if(200===(c=e.sent).status||c.data.success){e.next=15;break}throw new Error({status:c.status,message:c.statusText});case 15:(o=c.data.features.map(function(e){return y(e)})).forEach(function(e){var t=Object(p.transformCoordinatesWgs84ToLocalProjection)([e.getLng(),e.getLat()]);e.setCoordinates(t)}),e.next=21;break;case 19:e.prev=19,e.t0=e.catch(5);case 21:return e.abrupt("return",o);case 22:case"end":return e.stop()}},e,null,[[5,19]])}))).apply(this,arguments)}function o(e){return i.apply(this,arguments)}function i(){return(i=t(regeneratorRuntime.mark(function e(t){var r,n,o,i,a,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.request("Reachability","getSettings").geosearch,n=[],t.length<r.minChars)return e.abrupt("return",n);e.next=4;break;case 4:return e.prev=4,o=r.serviceId,i=f.request("RestReader","getServiceById",o).get("url").replace("geosearch.json","suggest"),a="".concat(i,"?count=").concat(r.limit,"&properties=text"),s="&query=".concat(encodeURIComponent(t)),e.next=11,d.a.get(a+s);case 11:if(200===(u=e.sent).status||u.data){e.next=14;break}throw new Error({status:u.status,message:u.statusText});case 14:n=u.data.map(function(e){return e.suggestion}),e.next=19;break;case 17:e.prev=17,e.t0=e.catch(4);case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}},e,null,[[4,17]])}))).apply(this,arguments)}function a(e){return s.apply(this,arguments)}function s(){return(s=t(regeneratorRuntime.mark(function e(t){var r,n,o,i,a,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,n=f.request("Reachability","getSettings").geosearchReverse,o=n.serviceId,i=n.filter,a=f.request("RestReader","getServiceById",o).get("url"),s="&filter="+(i||"typ:haus"),u="".concat(a,"?lon=").concat(t[0],"&lat=").concat(t[1],"&count=1&properties=text&distance=").concat(n.distance).concat(s),e.next=10,d.a.get(u);case 10:if(200===(c=e.sent).status||c.data.success){e.next=13;break}throw new Error({status:c.status,message:c.statusText});case 13:if(h.isEmpty(c.data.features))return e.abrupt("return",new g.default(t[0],t[1]));e.next=15;break;case 15:r=y(c.data.features[0]),l=Object(p.transformCoordinatesWgs84ToLocalProjection)([r.getLng(),r.getLat()]),r.setCoordinates(l),e.next=22;break;case 20:e.prev=20,e.t0=e.catch(1);case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}},e,null,[[1,20]])}))).apply(this,arguments)}function y(e){return new g.default(Number(e.geometry.coordinates[1]),Number(e.geometry.coordinates[0]),e.properties.text)}}.call(this,l(4),l(3))},1883:function(e,t,r){"use strict";r.r(t);var n=r(1799),o=r(1839),i=r(43);t.default=new i.a({source:n.default,style:o.default,name:"reachability_startingpoint_layer",alwaysOnTop:!0})},1884:function(e,t,r){"use strict";r.r(t);var n=r(362),o=r(1799);t.default=new n.a({source:o.default})},1885:function(e,t,r){"use strict";r.r(t);var n=r(1100),o=r(1799);t.default=new n.a({source:o.default})},1886:function(e,t,r){"use strict";r.r(t);var n=r(241),o=r(1839),i=r(1799);t.default=new n.b({source:i.default,type:"Point",style:o.default})},1887:function(e,t,r){"use strict";r.r(t);var n=r(1823),o=r(1828),i=r(43);t.default=new i.a({source:n.default,style:o.default,name:"isochrones_area_layer",alwaysOnTop:!0,opacity:.65})},1954:function(e,y,m){"use strict";m.r(y),function(e){var t=m(1823),r=m(1883),n=m(1884),o=m(1885),i=m(1886),a=m(36),s=m(42),u=m(5),c=m(1853),l=m(1800),f=m(1887),h=m(1799);function d(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function p(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function o(e){d(n,t,r,o,i,"next",e)}function i(e){d(n,t,r,o,i,"throw",e)}o(void 0)})}}var g=e.View.extend({model:null,isMapListenerAdded:!1,initialize:function(){this.listenTo(this.model,{"change:isochronesResult":this.updateArea}),u.Radio.channel("Reachability").on({zoomToArea:this.zoomToArea},this)},initIsochrones:function(e){if(e){this.isMapListenerAdded||(i.default.on("drawend",this.onStartingPointDrawEnd.bind(this)),this.createWaypointsModifyInteractionListener(),this.isMapListenerAdded=!0);var t=u.Radio.request("Map","getLayers");u.Radio.trigger("Map","addLayerToIndex",[f.default,t.getArray().length]),u.Radio.trigger("Map","addLayerToIndex",[r.default,t.getArray().length+1]),this.createWaypointsDrawInteraction()}else this.closeIsochrones()},closeIsochrones:function(){u.Radio.trigger("Map","removeLayer",r.default),u.Radio.trigger("Map","removeLayer",f.default),this.removeMapInteractions()},zoomToArea:function(){u.Radio.trigger("Map","zoomToExtent",t.default.getExtent())},createWaypointsModifyInteractionListener:function(){var i=this;n.default.on("modifyend",p(regeneratorRuntime.mark(function e(){var t,r,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.model.getStartingPoint(),r=t.getCoordinates(),n=Object(l.transformCoordinatesLocalToWgs84Projection)(r),e.next=5,Object(c.fetchTextByCoordinates)(n);case 5:o=e.sent,t.setDisplayName(null==o?void 0:o.getDisplayName()),i.model.findIsochrones();case 8:case"end":return e.stop()}},e)})))},onStartingPointDrawEnd:function(i){var a=this;return p(regeneratorRuntime.mark(function e(){var t,r,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.model.getStartingPoint(),r=i.feature.getGeometry().getCoordinates(),n=Object(l.transformCoordinatesLocalToWgs84Projection)(r),e.next=5,Object(c.fetchTextByCoordinates)(n);case 5:o=e.sent,h.default.removeFeature(i.feature),t.setDisplayName(null==o?void 0:o.getDisplayName()),t.setCoordinates(r),a.model.findIsochrones();case 10:case"end":return e.stop()}},e)}))()},updateArea:function(){t.default.clear();var e=this.model.getIsochronesResult();e&&!e.getError()&&(t.default.addFeatures(e.getAreas().map(function(e){return new a.a({geometry:new s.b(e.getCoordinates()),value:e.getValue(),maximum:e.getMaximum(),interval:e.getInterval(),speedProfile:e.getSpeedProfile(),optimization:e.getOptimization(),color:e.getColor(),avoidSpeedProfileOptions:e.getAvoidSpeedProfileOptions()})})),this.zoomToArea())},createWaypointsDrawInteraction:function(){this.removeMapInteractions(),u.Radio.trigger("Map","addInteraction",i.default),u.Radio.trigger("Map","addInteraction",n.default),u.Radio.trigger("Map","addInteraction",o.default)},removeWaypointsDrawInteraction:function(){u.Radio.trigger("Map","removeInteraction",i.default),u.Radio.trigger("Map","removeInteraction",n.default),u.Radio.trigger("Map","removeInteraction",o.default)},removeMapInteractions:function(){this.removeWaypointsDrawInteraction()}});y.default=g}.call(this,m(5))}}]);