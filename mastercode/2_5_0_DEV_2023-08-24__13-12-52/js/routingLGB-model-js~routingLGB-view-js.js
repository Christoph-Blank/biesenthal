(window.webpackJsonp=window.webpackJsonp||[]).push([[13,279,280,281,282,283,289,290,291,316],{1802:function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"default",function(){return r});var r=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.lat=e,this.lng=t,this.displayName=n,this.coordinates=[]}var e,t,n;return e=r,(t=[{key:"getLat",value:function(){return this.lat}},{key:"setLat",value:function(e){this.lat=e}},{key:"getLng",value:function(){return this.lng}},{key:"setLng",value:function(e){this.lng=e}},{key:"getDisplayName",value:function(){return this.displayName}},{key:"setDisplayName",value:function(e){this.displayName=e}},{key:"getCoordinates",value:function(){return this.coordinates}},{key:"setCoordinates",value:function(e){this.coordinates=e}}])&&i(e.prototype,t),n&&i(e,n),r}()},1814:function(e,t,n){"use strict";n.r(t);var r=n(41);t.default=new r.a},1826:function(e,t,n){"use strict";function r(e){return Math.floor(e/60)}function i(e){return Math.floor(e/3600)}function o(e){return Math.floor(e/60%60)}function a(e){if(!e||e<60)return"< 1 min";if(3600<e){var t=o(e);return i(e)+" h"+(0<t?" "+t+" min":"")}return r(e)+" min"}function s(e){return Math.floor(e)}function u(e){return Math.floor(s(e)/1e3*10)/10}function c(e){return e?s(e)<1e3?s(e)+" m":(u(e)+" km").replace(".",","):"0 m"}n.r(t),n.d(t,"durationInMinutes",function(){return r}),n.d(t,"minutesMinusHours",function(){return o}),n.d(t,"durationInHours",function(){return i}),n.d(t,"durationHumanized",function(){return a}),n.d(t,"distanceRounded",function(){return s}),n.d(t,"distanceInKm",function(){return u}),n.d(t,"distanceHumanized",function(){return c})},1850:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchRoutingNominatimGeosearch",function(){return s}),n.d(t,"fetchRoutingNominatimGeosearchReverse",function(){return f});var r=n(195),a=n.n(r),i=n(1802);function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function o(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){u(r,t,n,i,o,"next",e)}function o(e){u(r,t,n,i,o,"throw",e)}i(void 0)})}}function s(e){return c.apply(this,arguments)}function c(){return(c=o(regeneratorRuntime.mark(function e(t){var n,r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=store.getters.getRestServiceById(state.geosearch.serviceId).url,r="".concat(n,"&countrycodes=de&format=json&limit=").concat(state.geosearch.limit,"&bounded=1"),i="&q=".concat(encodeURIComponent(t)),e.next=5,a.a.get(r+i);case 5:if(200===(o=e.sent).status||o.data.success){e.next=8;break}throw new Error({status:o.status,message:o.statusText});case 8:return e.abrupt("return",o.data.map(function(e){return d(e)}));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(e){return l.apply(this,arguments)}function l(){return(l=o(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=store.getters.getRestServiceById(state.geosearchReverse.serviceId).url,r="".concat(n,"&lon=").concat(t[0],"&lat=").concat(t[1],"&format=json&addressdetails=0"),e.next=4,a.a.get(r);case 4:if(200===(i=e.sent).status||i.data.success){e.next=7;break}throw new Error({status:i.status,message:i.statusText});case 7:return e.abrupt("return",d(i.data));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function d(e){return new i.default(Number(e.lat),Number(e.lon),e.display_name)}},1851:function(e,h,p){"use strict";p.r(h),function(c,f){p.d(h,"fetchRoutingBkgGeosearch",function(){return n}),p.d(h,"fetchRoutingBkgGeosearchReverse",function(){return a}),p.d(h,"fetchBkgGeosearchSuggestions",function(){return i});var e=p(195),l=p.n(e),d=p(1802);function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function t(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){u(r,t,n,i,o,"next",e)}function o(e){u(r,t,n,i,o,"throw",e)}i(void 0)})}}function n(e){return r.apply(this,arguments)}function r(){return(r=t(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.request("RoutingLGB","getSettings").geosearch,r=n.serviceId,i=c.request("RestReader","getServiceById",r).get("url"),o="".concat(i,"?count=").concat(n.limit,"&properties=text"),a="&query=".concat(encodeURIComponent(t)),e.next=7,l.a.get(o+a,{timeout:n.timeout});case 7:if(200===(s=e.sent).status||s.data.success){e.next=10;break}throw new Error({status:s.status,message:s.statusText});case 10:return e.abrupt("return",s.data.features.map(function(e){return g(e)}));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function i(e){return o.apply(this,arguments)}function o(){return(o=t(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.request("RoutingLGB","getSettings").geosearch,r=n.serviceId,i=c.request("RestReader","getServiceById",r).get("url").replace("geosearch.json","suggest"),o="".concat(i,"?count=").concat(n.limit,"&properties=text"),a="&query=".concat(encodeURIComponent(t)),e.next=7,l.a.get(o+a,{timeout:n.timeout});case 7:if(200===(s=e.sent).status||s.data){e.next=10;break}throw new Error({status:s.status,message:s.statusText});case 10:return e.abrupt("return",s.data.map(function(e){return e.suggestion}));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function a(e){return s.apply(this,arguments)}function s(){return(s=t(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.request("RoutingLGB","getSettings").geosearchReverse,r=n.serviceId,i=n.filter,o=c.request("RestReader","getServiceById",r).get("url"),a="&filter="+(i||"typ:haus"),s="".concat(o,"?lon=").concat(t[0],"&lat=").concat(t[1],"&count=1&properties=text&distance=").concat(n.distance).concat(a),e.next=8,l.a.get(s,{timeout:n.timeout});case 8:if(200===(u=e.sent).status||u.data.success){e.next=11;break}throw new Error({status:u.status,message:u.statusText});case 11:if(f.isEmpty(u.data.features))return e.abrupt("return",new d.default(t[0],t[1]));e.next=13;break;case 13:return e.abrupt("return",g(u.data.features[0]));case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e){return new d.default(Number(e.geometry.coordinates[1]),Number(e.geometry.coordinates[0]),e.properties.text)}}.call(this,p(4),p(3))},1854:function(e,d,g){"use strict";g.r(d),function(o){g.d(d,"fetchCoordinatesByText",function(){return t}),g.d(d,"fetchTextByCoordinates",function(){return f}),g.d(d,"fetchSuggestionsByText",function(){return r});var a=g(1850),s=g(1851),u=g(1809);g(1802);function c(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function e(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){c(r,t,n,i,o,"next",e)}function o(e){c(r,t,n,i,o,"throw",e)}i(void 0)})}}function t(e){return n.apply(this,arguments)}function n(){return(n=e(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.search,r=o.request("RoutingLGB","getSettings").geosearch,i=[],n.length<r.minChars)return e.abrupt("return",i);e.next=5;break;case 5:if(e.prev=5,"NOMINATIM"===r.type)return e.next=9,Object(a.fetchRoutingNominatimGeosearch)(n);e.next=12;break;case 9:i=e.sent,e.next=19;break;case 12:if("BKG"===r.type)return e.next=15,Object(s.fetchRoutingBkgGeosearch)(n);e.next=18;break;case 15:i=e.sent,e.next=19;break;case 18:throw new Error("Geosearch is not configured correctly.");case 19:i.forEach(function(e){var t=Object(u.transformCoordinatesWgs84ToLocalProjection)([e.getLng(),e.getLat()]);e.setCoordinates(t)}),e.next=24;break;case 22:e.prev=22,e.t0=e.catch(5);case 24:return e.abrupt("return",i);case 25:case"end":return e.stop()}},e,null,[[5,22]])}))).apply(this,arguments)}function r(e){return i.apply(this,arguments)}function i(){return(i=e(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.request("RoutingLGB","getSettings").geosearch,r=[],t.length<n.minChars)return e.abrupt("return",r);e.next=4;break;case 4:return e.prev=4,e.next=7,Object(s.fetchBkgGeosearchSuggestions)(t);case 7:r=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}},e,null,[[4,10]])}))).apply(this,arguments)}function f(e){return l.apply(this,arguments)}function l(){return(l=e(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.request("RoutingLGB","getSettings").geosearch,r=null,e.prev=2,"NOMINATIM"===n.type)return e.next=6,Object(a.fetchRoutingNominatimGeosearchReverse)(t);e.next=9;break;case 6:r=e.sent,e.next=16;break;case 9:if("BKG"===n.type)return e.next=12,Object(s.fetchRoutingBkgGeosearchReverse)(t);e.next=15;break;case 12:r=e.sent,e.next=16;break;case 15:throw new Error("Geosearch is not configured correctly.");case 16:i=Object(u.transformCoordinatesWgs84ToLocalProjection)([r.getLng(),r.getLat()]),r.setCoordinates(i),e.next=22;break;case 20:e.prev=20,e.t0=e.catch(2);case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}},e,null,[[2,20]])}))).apply(this,arguments)}}.call(this,g(4))},1888:function(e,t,n){"use strict";n.r(t);var r=n(50),i=n(36),o=n(5),a=n.n(o).a.Model.extend({defaults:{index:0,feature:null,displayName:"",source:null,addedToSource:!1,indexDirectionsLineString:null,coordinates:[]},initialize:function(){var n=this;this.getFeature()?(this.getFeature().set("routingId",this.getIndex()),this.set("coordinates",this.getFeature().getGeometry().getCoordinates()),this.set("addedToSource",!0)):(this.set("coordinates",[]),this.set("feature",new i.a({geometry:new r.a(this.getCoordinates()),routingId:this.getIndex()}))),this.getFeature().getGeometry().on("change",function(e){var t=e.target;n.set("coordinates",t.getCoordinates())})},getIndex:function(){return this.get("index")},setIndex:function(e){this.set("index",e),this.getFeature().set("routingId",e)},getCoordinates:function(){return this.get("coordinates")},setCoordinates:function(e){this.set("coordinates",e),this.getFeature().getGeometry().setCoordinates(e),this.isAddedToSource()||(this.get("source").addFeature(this.getFeature()),this.set("addedToSource",!0)),this.trigger("changeCoordinates")},hasCoordinates:function(){return this.getCoordinates()&&2===this.getCoordinates().length},getFeature:function(){return this.get("feature")},getDisplayName:function(){return this.get("displayName")?this.get("displayName"):this.hasCoordinates()?"".concat(this.getCoordinates()[0],", ").concat(this.getCoordinates()[1]):null},setDisplayName:function(e){this.set("displayName",e)},isAddedToSource:function(){return this.get("addedToSource")},setFromGeosearchResult:function(e){this.setDisplayName(e.getDisplayName()),this.setCoordinates(e.getCoordinates())},getIndexDirectionsLineString:function(){return this.get("indexDirectionsLineString")},setIndexDirectionsLineString:function(e){this.set("indexDirectionsLineString",e)},removeFromSource:function(){this.isAddedToSource()&&this.get("source").removeFeature(this.getFeature()),this.set("addedToSource",!1)},reset:function(){this.set("displayName",null),this.set("indexDirectionsLineString",null),this.removeFromSource(),this.getFeature().getGeometry().setCoordinates([]),this.trigger("changeCoordinates")}});t.default=a},1889:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var r=n(1826);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function s(e){var t=e.bbox,n=e.distance,r=e.duration,i=e.lineString,o=e.lineStringWaypointIndex,a=e.error;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.bbox=t,this.distance=n,this.duration=r,this.lineString=i,this.lineStringWaypointIndex=o,this.segments=[],this.error=a,this.zoomToExtent=!1}var e,t,n;return e=s,(t=[{key:"getBbox",value:function(){return this.bbox}},{key:"getDistanceMeter",value:function(){return this.distance}},{key:"getDurationSeconds",value:function(){return this.duration}},{key:"getLineString",value:function(){return this.lineString}},{key:"getSegments",value:function(){return this.segments}},{key:"getLineStringWaypointIndex",value:function(){return this.lineStringWaypointIndex}},{key:"getError",value:function(){return this.error}},{key:"getDurationHumanized",value:function(){return Object(r.durationHumanized)(this.duration)}},{key:"getDistanceHumanized",value:function(){return Object(r.distanceHumanized)(this.distance)}},{key:"getZoomToExtent",value:function(){return this.zoomToExtent}},{key:"setZoomToExtent",value:function(e){this.zoomToExtent=e}},{key:"hasIntermediateWaypoints",value:function(){return this.segments&&1<this.segments.length}}])&&i(e.prototype,t),n&&i(e,n),s}()},1890:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n(1826);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u={"fa-map-marker-alt":["ziel","erreichen","destination"],"fa-arrow-circle-right":["rechts","right"],"fa-arrow-circle-left":["links","left"],"fa-circle-notch":["kreisverkehr","roundabout"]},s=function(){function s(e){var t=e.distance,n=e.duration,r=e.instruction,i=e.name,o=e.type,a=e.waypoints;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.distance=t,this.duration=n,this.instruction=r,this.name=i,this.type=o,this.waypoints=a}var e,t,n;return e=s,(t=[{key:"getDistance",value:function(){return this.distance}},{key:"getDuration",value:function(){return this.duration}},{key:"getInstruction",value:function(){return this.instruction}},{key:"getName",value:function(){return this.name}},{key:"getType",value:function(){return this.type}},{key:"getWaypoints",value:function(){return this.waypoints}},{key:"getFaIconClass",value:function(){if(!this.instruction)return"fa-arrow-circle-up";for(var t=this.instruction.toLowerCase(),e=0,n=Object.entries(u);e<n.length;e++){var r=o(n[e],2),i=r[0];if(r[1].some(function(e){return t.includes(e)}))return i}return"fa-arrow-circle-up"}},{key:"getDurationHumanized",value:function(){return Object(r.durationHumanized)(this.duration)}},{key:"getDistanceHumanized",value:function(){return Object(r.distanceHumanized)(this.distance)}}])&&a(e.prototype,t),n&&a(e,n),s}()},1891:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var r=n(1826);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function i(e){var t=e.distance,n=e.duration,r=e.steps;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.distance=t,this.duration=n,this.steps=r,this.displayDetails=!1}var e,t,n;return e=i,(t=[{key:"getDistance",value:function(){return this.distance}},{key:"getDuration",value:function(){return this.duration}},{key:"getSteps",value:function(){return this.steps}},{key:"getDisplayDetails",value:function(){return this.displayDetails}},{key:"getDurationHumanized",value:function(){return Object(r.durationHumanized)(this.duration)}},{key:"getDistanceHumanized",value:function(){return Object(r.distanceHumanized)(this.distance)}}])&&o(e.prototype,t),n&&o(e,n),i}()},1955:function(e,t,n){"use strict";n.r(t);var u=n(1814),r=n(1808),i=n(1809),o=n(5),a=n.n(o),c=n(1888),s=a.a.Collection.extend({initialize:function(){for(var e=this.length;e<2;e++)this.addWaypoint({index:e})},filterWithCoordinates:function(){return this.filter(function(e){return e.hasCoordinates()})},getDirectionsCoordinates:function(){return this.map(function(e){return e.getCoordinates()}).filter(function(e){return 2===e.length})},getDirectionsCoordinatesWgs84:function(){return this.getDirectionsCoordinates().map(function(e){return Object(i.transformCoordinatesLocalToWgs84Projection)(e)})},addWaypoint:function(e){var t=e.index,n=e.feature,r=e.displayName,i=t;if("number"!=typeof t&&(i=this.length),n){var o=this.find(function(e){return 0===e.getCoordinates().length});if(o)return r&&o.setDisplayName(r),o.setCoordinates(n.getGeometry().getCoordinates()),setTimeout(function(){u.default.removeFeature(n)}),o}var a=new c.default({index:i,feature:n,displayName:r,source:u.default});this.add(a,{at:i});for(var s=i+1;s<this.length;s++)this.at(s).setIndex(s);return a},removeWaypoint:function(e){if(2===this.length)return this.at(e).reset(),r.default.getFeatures().forEach(function(e){return e.getGeometry().setCoordinates([])}),void o.Radio.trigger("RoutingLGB","findRoute");this.at(e).removeFromSource();for(var t=e;t<this.length;t++)this.at(t).setIndex(this.at(t).getIndex()-1);this.remove(this.at(e)),o.Radio.trigger("RoutingLGB","findRoute")},resetWaypoints:function(){this.forEach(function(e){e.isAddedToSource()&&u.default.removeFeature(e.getFeature())}),this.reset(),this.initialize(),o.Radio.trigger("RoutingLGB","findRoute")},moveWaypoint:function(e,t){var n=this.slice();e<0||t<0||e>=this.length||t>=this.length||e===t||(n.splice(t,0,n.splice(e,1)[0]),this.set(n),this.forEach(function(e,t){return e.setIndex(t)}),o.Radio.trigger("RoutingLGB","findRoute"))},isRoutable:function(){return 2<=this.filter(function(e){return e.hasCoordinates()}).length}});t.default=s},1956:function(e,a,s){"use strict";s.r(a),function(E){s.d(a,"fetchRoutingOrs",function(){return n});var e=s(195),L=s.n(e),t=s(14),T=s.n(t),F=s(1807),W=s(1809),G=s(1889),B=s(1890),N=s(1891);function M(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function n(e){return o.apply(this,arguments)}function o(){var s;return s=regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s,u,c,f,l,d,g,h,p,v,y,m,b,R,x,w,k,O,S,C,I,P,j,D,A;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.coordinates,r=t.language,i=t.speedProfile,o=t.avoidFeatureOptions,a=t.preference,s=t.avoidPolygons,u=t.instructions,c=E.request("RoutingLGB","getSettings").routing,f=c.serviceId,l=E.request("RestReader","getServiceById",f),d=c.useTrafficFlow&&[F.SpeedProfile.CAR.id,F.SpeedProfile.HGV.id].includes(i),g=d?"_st":"",h="".concat(l.get("url"),"/v2/directions").concat(g,"/").concat(F.SpeedProfile[i].orsKey,"/geojson"),x=R=b=m=y=v=p=null,e.prev=3,e.next=6,L.a.post(h,{coordinates:n,language:r,options:z(z({},0<o.length&&{avoid_features:o.map(function(e){return F.AvoidFeatureOption[e].orsKey})}),{},{avoid_polygons:s}),preference:F.Preference[a].orsKey,units:"m",geometry:!0,departure:T()().toISOString(!0).substring(0,16),instructions:u},{timeout:c.timeout});case 6:x=e.sent,e.next=20;break;case 9:if(e.prev=9,e.t0=e.catch(3),"ECONNABORTED"===e.t0.code)return e.abrupt("return",new G.default({error:F.RoutingResultError.SERVICE_UNAVAILABLE}));e.next=13;break;case 13:if(!e.t0.response){e.next=19;break}if(404===e.t0.response.status)return e.abrupt("return",new G.default({error:F.RoutingResultError.NO_ROUTE_FOUND}));e.next=16;break;case 16:if(!e.t0.response.data||!e.t0.response.data.error){e.next=19;break}if(2003===e.t0.response.data.error.code)return e.abrupt("return",new G.default({error:F.RoutingResultError.AVOID_AREA_TOO_LARGE}));e.next=19;break;case 19:return e.abrupt("return",new G.default({error:F.RoutingResultError.FETCHING_FAILED}));case 20:p=x.data,v=p.features[0],y=Object(W.transformCoordinatesWgs84ToLocalProjection)([v.bbox[0],v.bbox[1]]),m=Object(W.transformCoordinatesWgs84ToLocalProjection)([v.bbox[2],v.bbox[3]]),b=[],w=M(v.geometry.coordinates);try{for(w.s();!(k=w.n()).done;)O=k.value,b.push(Object(W.transformCoordinatesWgs84ToLocalProjection)(O))}catch(e){w.e(e)}finally{w.f()}if(R=new G.default({bbox:[y[0],y[1],m[0],m[1]],lineString:b,distance:v.properties.summary.distance,duration:v.properties.summary.duration,lineStringWaypointIndex:v.properties.way_points}),v.properties.segments){S=M(v.properties.segments);try{for(S.s();!(C=S.n()).done;){I=C.value,P=new N.default({distance:I.distance,duration:I.duration,steps:[]}),j=M(I.steps);try{for(j.s();!(D=j.n()).done;)A=D.value,P.steps.push(new B.default({distance:A.distance,duration:A.duration,instruction:A.instruction,name:A.name,type:A.type,waypoints:A.way_points}))}catch(e){j.e(e)}finally{j.f()}R.segments.push(P)}}catch(e){S.e(e)}finally{S.f()}}return e.abrupt("return",R);case 30:case"end":return e.stop()}},e,null,[[3,9]])}),(o=function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){c(r,t,n,i,o,"next",e)}function o(e){c(r,t,n,i,o,"throw",e)}i(void 0)})}).apply(this,arguments)}}.call(this,s(4))},1981:function(e,p,v){"use strict";v.r(p),function(n,o){var e=v(18),c=v(5),r=v(1807),i=v(1955),a=v(1956),f=v(1854),l=v(1809),s=v(1808);function u(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function t(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){g(r,t,n,i,o,"next",e)}function o(e){g(r,t,n,i,o,"throw",e)}i(void 0)})}}var h=e.a.extend({defaults:{isActive:!1,renderToWindow:!1,resizableWindow:!0,isVisibleInMenu:!0,deactivateGFI:!0,id:"routingLGB",name:"Routing",geosearch:{minChars:3,limit:10,type:null,serviceId:null,timeout:1500},geosearchReverse:{type:null,serviceId:null,distance:1e3,filter:null,timeout:1500},routingSettings:{type:null,serviceId:null,timeout:5e3,useTrafficFlow:!1,styleRoute:{fillColor:[255,44,0],width:6,highlightColor:[255,255,255],highlightWidth:9,partHighlightColor:[255,255,255],partHighlightWidth:3},styleWaypoint:{lineColor:[255,127,0],lineWidth:4,fillColor:[255,127,0],textFillColor:"#000",textLineColor:"#fff",textLineWidth:3,opacity:.3,radius:8},styleAvoidAreas:{lineColor:[0,127,255],lineWidth:2,fillColor:[0,127,255],opacity:.3,pointRadius:8,pointLineWidth:4}},speedProfile:r.SpeedProfile.CAR.id,preference:r.Preference.RECOMMENDED.id,mapInteractionMode:r.MapInteractionMode.WAYPOINTS,waypoints:[],avoidFeatureOptions:[],routingResult:null,isLoadingRoute:!1,isRouteDetailsOpen:!1},initialize:function(){var e=this;this.superInitialize(),this.set("waypoints",new i.default),this.listenTo(this,{"change:speedProfile change:preference change:avoidFeatureOptions":this.findRoute,"change:isActive change:routingResult":this.notifyElevationProfile});var t=c.Radio.channel("RoutingLGB");t.reply({getSettings:this.getSettings},this),t.on({open:this.open,openRouteDetails:function(){return e.setRouteDetailsOpen(!0)},closeRouteDetails:function(){return e.setRouteDetailsOpen(!1)},findRoute:this.findRoute},this)},getSettings:function(){return{geosearch:n.extend(this.defaults.geosearch,this.get("geosearch")),geosearchReverse:n.extend(this.defaults.geosearchReverse,this.get("geosearchReverse")),routing:n.extend(this.defaults.routingSettings,this.get("routingSettings"))}},getWaypoints:function(){return this.get("waypoints")},getMapInteractionMode:function(){return this.get("mapInteractionMode")},setMapInteractionMode:function(e){this.set("mapInteractionMode",e)},isLoadingRoute:function(){return this.get("isLoadingRoute")},isRouteDetailsOpen:function(){return this.get("isRouteDetailsOpen")},setRouteDetailsOpen:function(e){this.set("isRouteDetailsOpen",e)},getSpeedProfile:function(){return this.get("speedProfile")},setSpeedProfile:function(e){this.set("speedProfile",e)},getAvoidFeatureOptions:function(){return this.get("avoidFeatureOptions")},getPreference:function(){return this.get("preference")},setPreference:function(e){this.set("preference",e)},getRoutingResult:function(){return this.get("routingResult")},setRoutingResult:function(e){this.set("routingResult",e)},open:function(s){var u=this;return t(regeneratorRuntime.mark(function e(){var t,n,r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.waypoint,(n=c.Radio.request("ModelList","getCollection"))&&n.setActiveToolsToFalse(u),u.setIsActive(!0),!t){e.next=21;break}if(r=(r=u.getWaypoints().findWhere(function(e){return!e.hasCoordinates()}))||u.getWaypoints().addWaypoint({index:u.getWaypoints().length}),i=null,t.coordinates)return o=Object(l.transformCoordinatesLocalToWgs84Projection)(t.coordinates),e.next=12,Object(f.fetchTextByCoordinates)(o);e.next=15;break;case 12:i=e.sent,e.next=20;break;case 15:if(t.text)return e.next=18,Object(f.fetchCoordinatesByText)({search:t.text});e.next=20;break;case 18:a=e.sent,i=0<a.length?a[0]:null;case 20:i&&(u.setRouteDetailsOpen(!1),r.setFromGeosearchResult(i),u.getWaypoints().filter(function(e){return e.hasCoordinates()}).length<2&&c.Radio.trigger("MapView","setCenter",i.getCoordinates()),c.Radio.trigger("RoutingLGB","focusEmptyWaypoint"),c.Radio.trigger("RoutingLGB","findRoute",{zoomToExtent:!0}));case 21:case"end":return e.stop()}},e)}))()},getFilteredAvoidFeatureOptions:function(){var t=this.getAvailableAvoidFeatureOptions().map(function(e){return e.id});return n.filter(this.get("avoidFeatureOptions"),function(e){return t.includes(e)})},getAvailableAvoidFeatureOptions:function(){var t=this;return Object.values(r.AvoidFeatureOption).filter(function(e){return e.availableProfiles.includes(t.getSpeedProfile())})},toggleAvoidFeatureOption:function(e){var t=this.getAvoidFeatureOptions();this.set("avoidFeatureOptions",t.includes(e)?n.without(t,e):[].concat(u(t),[e]))},isInputDisabled:function(){return this.isLoadingDirections()},findRoute:function(){var i=arguments,o=this;return t(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0<i.length&&void 0!==i[0]?i[0]:{}).zoomToExtent,n=void 0!==t&&t,o.getWaypoints().getDirectionsCoordinates().length<2)return o.setRoutingResult(null),e.abrupt("return");e.next=4;break;case 4:return o.set("isLoadingRoute",!0),e.next=7,o.fetchRoute();case 7:(r=e.sent).setZoomToExtent(n),r.getError()?o.setRouteDetailsOpen(!1):o.getWaypoints().forEach(function(e,t){e.setIndexDirectionsLineString(r.getLineStringWaypointIndex()[t])}),o.setRoutingResult(r),o.set("isLoadingRoute",!1);case 12:case"end":return e.stop()}},e)}))()},fetchRoute:function(){var i=this;return t(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.getSettings().routing,n=c.Radio.request("RoutingLGB","getAvoidPolygonsWgs84"),r=i.getWaypoints().getDirectionsCoordinatesWgs84(),"ORS"===t.type)return e.next=4,Object(a.fetchRoutingOrs)({coordinates:r,language:o.language,speedProfile:i.getSpeedProfile(),avoidFeatureOptions:i.getFilteredAvoidFeatureOptions(),preference:i.getPreference(),avoidPolygons:n,instructions:!0});e.next=5;break;case 4:return e.abrupt("return",e.sent);case 5:throw new Error("fetchRoute Type is not configured correctly.");case 6:case"end":return e.stop()}},e)}))()},notifyElevationProfile:function(){var e=this.getRoutingResult();if(this.get("isActive")&&e&&!e.getError()){var t={coordinates:e.getLineString(),olSource:s.default,olFeature:s.default.getFeatures().find(function(e){return!e.get("isHighlight")})},n=[r.SpeedProfile.CAR.id,r.SpeedProfile.HGV.id].includes(this.getSpeedProfile());c.Radio.request("ElevationProfile","isOpen")&&n||(t.minimize=n),c.Radio.trigger("ElevationProfile","open",t)}else c.Radio.trigger("ElevationProfile","close")}});p.default=h}.call(this,v(3),v(24))}}]);