(window.webpackJsonp=window.webpackJsonp||[]).push([[202,195,196,197,198,199,200,201,203,204],{1836:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"default",function(){return i});var i=function(){function s(e,t){var n=e.x,r=e.y,i=e.z,o=e.dist;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var a=[n,r,i];t&&(a=t(a)),this.distance=o,this.coordinates=a}var e,t,n;return e=s,(t=[{key:"getDistance",value:function(){return this.distance}},{key:"getX",value:function(){return this.coordinates[0]}},{key:"getY",value:function(){return this.coordinates[1]}},{key:"getZ",value:function(){return this.coordinates[2]}}])&&r(e.prototype,t),n&&r(e,n),s}()},1840:function(e,s,u){"use strict";u.r(s),function(t){u.d(s,"transformCoordinatesLocalToWgs84Projection",function(){return e}),u.d(s,"transformCoordinatesWgs84ToLocalProjection",function(){return r}),u.d(s,"transformCoordinatesLocalToEPSG25833Projection",function(){return i}),u.d(s,"transformCoordinatesEPSG25833ToLocalProjection",function(){return o}),u.d(s,"calculateRelativeDistance",function(){return a});var n=u(55),d=u(63),f=u(50),h=u(1);function e(e){return Object(n.e)(t.request("MapView","getProjection").getCode(),"EPSG:4326",e)}function r(e){return Object(n.e)("EPSG:4326",t.request("MapView","getProjection").getCode(),e)}function i(e){return Object(n.e)(t.request("MapView","getProjection").getCode(),"EPSG:25833",e)}function o(e){return Object(n.e)("EPSG:25833",t.request("MapView","getProjection").getCode(),e)}function a(e,t){for(var n=e.getGeometry(),r=n.getClosestPoint(t),i=n.getCoordinates(),o=0,a=!1,s=0;s<i.length-1;s++){var u=i[s],c=i[s+1],l=new d.a([u,c]);if(l.intersectsExtent(Object(h.c)(new f.a(r).getExtent(),.001))){o+=new d.a([u,r]).getLength(),a=!0;break}o+=l.getLength()}return a?o/n.getLength():0}}.call(this,u(4))},1847:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var i=n(3);n(1836);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.steps=e,this.error=t}var e,t,r;return e=n,r=[{key:"createErrorResult",value:function(e){return new n(null,e)}}],(t=[{key:"getSteps",value:function(){return this.steps}},{key:"getError",value:function(){return this.error}},{key:"hasNoError",value:function(){return!this.error}},{key:"getDistance",value:function(){var e=i.default.last(this.steps);return e?e.getDistance():0}},{key:"getMaxHeight",value:function(){return i.default.max(this.steps.map(function(e){return e.getZ()}))}},{key:"getMinHeight",value:function(){return i.default.min(this.steps.map(function(e){return e.getZ()}))}},{key:"getAscent",value:function(){return i.default.reduce(this.getHeightDifferences(),function(e,t){return 0<t?t+e:e},0)}},{key:"getDescent",value:function(){return Math.abs(i.default.reduce(this.getHeightDifferences(),function(e,t){return t<0?t+e:e},0))}},{key:"getHeightDifferences",value:function(){return this.steps.map(function(e,t,n){return 0==t?0:e.getZ()-n[t-1].getZ()})}},{key:"convertToGraphData",value:function(){return this.steps.map(function(e){return{x:e.getDistance(),y:e.getZ()}})}},{key:"convertToGraphDataAsPairs",value:function(){return this.convertToGraphData().reduce(function(e,t,n,r){return n<r.length-1&&e.push(r.slice(n,n+2)),e},[])}}])&&o(e.prototype,t),r&&o(e,r),n}()},1857:function(e,t,n){"use strict";n.r(t),n.d(t,"ResultError",function(){return r});var r=Object.freeze({NO_PROFILE_FOUND:{i18n:"noProfileFound"},FETCHING_FAILED:{i18n:"profileFetchFailed"},SERVICE_UNAVAILABLE:{i18n:"profileServiceUnavailable"}})},1878:function(e,r,i){"use strict";i.r(r),function(c){i.d(r,"fetchElevationProfile",function(){return t});var e=i(195),l=i.n(e),d=i(1840),f=i(1857),h=i(1847),g=i(1836);function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function t(e){return n.apply(this,arguments)}function n(){var s;return s=regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.request("ElevationProfile","getSettings"),r={type:"LineString",coordinates:t.map(d.transformCoordinatesLocalToEPSG25833Projection)},i=null,e.prev=2,o=n.serviceId,a=c.request("RestReader","getServiceById",o).get("url"),s="".concat(a,"/geojson/line"),e.next=6,l.a.post(s,r,{timeout:n.timeout});case 6:i=e.sent,e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(2),404==e.t0.response.status)return e.abrupt("return",h.default.createErrorResult(f.ResultError.NO_PROFILE_FOUND));e.next=13;break;case 13:return e.abrupt("return",h.default.createErrorResult(f.ResultError.FETCHING_FAILED));case 14:return u=i.data.map(function(e){return new g.default(e,d.transformCoordinatesEPSG25833ToLocalProjection)}),e.abrupt("return",new h.default(u));case 16:case"end":return e.stop()}},e,null,[[2,9]])}),(n=function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){u(r,t,n,i,o,"next",e)}function o(e){u(r,t,n,i,o,"throw",e)}i(void 0)})}).apply(this,arguments)}}.call(this,i(4))},1879:function(e,t,n){"use strict";function r(e){return Math.floor(e)}function i(e){return Math.floor(r(e)/1e3*10)/10}function o(e){return e?r(e)<1e3?r(e)+" m":(i(e)+" km").replace(".",","):"0 m"}n.r(t),n.d(t,"distanceRounded",function(){return r}),n.d(t,"distanceInKm",function(){return i}),n.d(t,"distanceHumanized",function(){return o})},1932:function(e,t,n){"use strict";n.r(t);var r=n(18),i=n(5),o=n(1878),a=(n(1847),n(106)),s=n(3);function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var c,l,d=r.a.extend({defaults:{id:"elevationProfile",serviceId:"lgb_elevation",timeout:1e4,styleChart:{markerWidth:5,ascentAngleRange:[0,.045]},sourceRoute:{olSource:null,olFeature:null,coordinates:null,minimize:!1},elevationResult:null,isOpen:!1,isMinimized:!1,isLoadingElevation:!1,requestCount:0},initialize:function(e){var t=this;this.set("styleChart",s.default.extend(this.defaults.styleChart,e.styleChart));var n=i.Radio.channel("ElevationProfile");n.reply({getSettings:this.getSettings,isOpen:function(){return t.isOpen()},isMinimized:function(){return t.isMinimized()}},this),n.on({open:this.open,close:function(){return t.set("isOpen",!1)}},this)},getSettings:function(){return this.toJSON()},getSourceRoute:function(){return this.get("sourceRoute")},getElevationResult:function(){return this.get("elevationResult")},isLoadingElevation:function(){return this.get("isLoadingElevation")},isOpen:function(){return this.get("isOpen")},isMinimized:function(){return this.get("isMinimized")},setMinimized:function(e){this.set("isMinimized",e)},hasSourceGeometry:function(){return this.getSourceRoute()&&this.getSourceRoute().olFeature&&this.getSourceRoute().olFeature.getGeometry()&&this.getSourceRoute().olSource},isSourceGeometryMultiLineString:function(){return this.hasSourceGeometry()&&this.getSourceRoute().olFeature.getGeometry()instanceof a.a},open:(c=regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.coordinates){e.next=2;break}return e.abrupt("return");case 2:return"minimize"in t&&this.set("isMinimized",t.minimize),this.set("isOpen",!0),this.set("isLoadingElevation",!0),this.set("sourceRoute",t),this.set("requestCount",this.get("requestCount")+1),n=this.get("requestCount"),e.next=10,Object(o.fetchElevationProfile)(t.coordinates);case 10:if(r=e.sent,n!==this.get("requestCount"))return e.abrupt("return");e.next=13;break;case 13:this.set("requestCount",0),this.set("isLoadingElevation",!1),this.set("elevationResult",r);case 16:case"end":return e.stop()}},e,this)}),l=function(){var e=this,a=arguments;return new Promise(function(t,n){var r=c.apply(e,a);function i(e){u(r,t,n,i,o,"next",e)}function o(e){u(r,t,n,i,o,"throw",e)}i(void 0)})},function(e){return l.apply(this,arguments)})});t.default=d},1933:function(e,s,u){"use strict";u.r(s),function(e,t,T,G,i){var F=u(475),A=u(476),I=u(155),D=u(66),V=u(56),q=u(57),H=u(273),N=u(260),_=u(51),n=u(2097),r=u.n(n),U=u(36),W=u(50),B=u(23),Z=u(78),K=u(34),$=u(37),J=u(1840);function X(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=e.View.extend({model:null,statusTemplate:t.template(r.a),pointerListeners:[],initialize:function(){this.listenTo(this.model,{"change:elevationResult":this.render,"change:isLoadingElevation":this.render},this)},getContainer:function(){return T("#elevation-chart")},destroy:function(t){var n=this;return new Promise(function(e){n.pointerListeners.forEach(function(e){return G.trigger("Map","unregisterListener","pointermove",e)}),n.pointerListeners.length=0,t&&n.getContainer().children().length?n.getContainer().children().fadeOut(100,function(){e()}):(n.getContainer().empty(),e())})},render:function(e){var t=this,n=i.t("additional:elevationProfile",{returnObjects:!0}),r=1!=e;this.destroy(r).then(function(){t.getContainer().empty(),!t.model.isMinimized()&&t.model.isOpen()&&(t.model.isLoadingElevation()||!t.model.getElevationResult()?t.renderStatusView({isLoading:!0,statusMessage:n.loadProfile}):t.model.getElevationResult().getError()?t.renderStatusView({hasError:!0,statusMessage:n[t.model.getElevationResult().getError().i18n]}):t.draw(r))})},renderStatusView:function(e){e=t.extend({hasError:!1,isLoading:!1,statusMessage:""},e),this.getContainer().append(this.statusTemplate(e)).fadeIn(200)},draw:function(e){function n(e){return e/1e3}var r=this,t=this.model.getElevationResult(),i=this.model.getElevationResult().getDistance()<3e3,m=t.convertToGraphData(),o=t.convertToGraphDataAsPairs(),v={top:5,right:20,bottom:20,left:40},a=this.getContainer().width()-v.left-v.right,p=this.getContainer().height()-v.top-v.bottom,s=this.model.getSettings().styleChart,y=Object(I.c)({decimal:","}),u=this.getThemeColor(),c=this.getThemeColorString(),l=s.ascentColorMax&&Array.isArray(s.ascentColorMax)?_.f.apply(void 0,X(s.ascentColorMax)):Object(_.f)(c),d=s.ascentColorMin&&Array.isArray(s.ascentColorMin)?_.f.apply(void 0,X(s.ascentColorMin)):Object(_.f)(c),b=Object(V.c)(function(e){return e.x}).left,C=function(e,t){return i?y.format(".0f")(e)+" m":y.format(t?".1f":".0f")(n(e))+" km"},f=Object(N.b)().clamp(!0).domain(s.ascentAngleRange).range([d,l]),h=Object(q.e)("#elevation-chart").append("svg").attr("width",this.getContainer().width()).attr("height",this.getContainer().height()).append("g").attr("transform","translate(".concat(v.left,", ").concat(v.top,")")).style("opacity",e?0:100),w=Object(N.b)().domain(Object(V.d)(m,function(e){return e.x})).range([0,a]);h.append("g").attr("transform","translate(0, ".concat(p,")")).call(Object(H.a)(w).ticks(8).tickFormat(function(e){return C(e,n(w.domain()[1])<8)}));var S=Object(N.b)().domain([Object(V.g)(m,function(e){return e.y}),Object(V.e)(m,function(e){return e.y})]).range([p,0]);h.append("g").call(Object(H.b)(S).ticks(Math.min(6,S.domain()[1]-S.domain()[0])).tickFormat(function(e){return y.format(".0f")(e)+" m"})),h.append("g").attr("class","elevationChartGrid").attr("transform","translate(0, ".concat(p,")")).call(Object(H.a)(w).ticks(8).tickSize(-p).tickFormat("")),h.append("g").attr("class","elevationChartGrid").call(Object(H.b)(S).ticks(6).tickSize(-a).tickFormat(""));var g=Object(F.a)().x(function(e){return w(e.x)}).y0(S(S.domain()[0])).y1(function(e){return S(e.y)});h.append("path").attr("d",g(m)).attr("class","elevationChartLineArea");var x=Object(F.b)().x(function(e){return w(e.x)}).y(function(e){return S(e.y)});h.selectAll(".elevationChartLine").data(o).enter().append("path").attr("d",x).attr("class","elevationChartLine").style("stroke",function(e){return f(((t=e)[1].y-t[0].y)/(t[1].x-t[0].x));var t});var E=h.append("g").attr("class","crossBar").style("display","none");E.append("line").attr("x1",0).attr("x2",0).attr("y1",p).attr("y2",0),this.getContainer().append('<div class=\'elevation-profile-hover-card\' style="display: none">\n            <span><i class="fas fa-arrows-alt-h"></i><span class="distance"></span></span>\n            <span><i class="fas fa-arrows-alt-v"></i><span class="height"></span></span>\n            </div>');var O=h.append("circle").attr("r",s.markerWidth).attr("class","marker").style("display","none").style("pointer-events","none"),M=new U.a({geometry:new W.a([0,0])}),R=new B.c({image:new Z.a({radius:s.markerWidth,stroke:new K.a({color:u,width:Math.round(s.markerWidth/3)}),fill:new $.a({color:[255,255,255]})})});M.setStyle(R);var j=this;function k(e){E.style("display",null),O.style("display","inherit"),T(".elevation-profile-hover-card").css("display","flex"),e&&j.model.hasSourceGeometry()&&!j.model.getSourceRoute().olSource.hasFeature(M)&&j.model.getSourceRoute().olSource.addFeature(M)}function P(){E.style("display","none"),O.style("display","none"),T(".elevation-profile-hover-card").css("display","none"),j.model.hasSourceGeometry()&&j.model.getSourceRoute().olSource.hasFeature(M)&&j.model.getSourceRoute().olSource.removeFeature(M)}function z(e,t){var n=w.invert(e),r=b(m,n),i=m[r<=0?0:r-1],o=m.length<=r?m[r-1]:m[r],a=Object(D.c)(i.y,o.y),s=o.x-i.x,u=r<=0||r==m.length?i.y:o.x===n?o.y:a(n%s/s);E.attr("transform","translate(".concat(w(n),", 0)")),O.attr("cx",e),O.attr("cy",S(u));var c=T(".elevation-profile-hover-card").outerWidth(!0),l=T(".elevation-profile-hover-card").height(),d=e+v.left-c/2,f=Math.min(Math.max(Math.round(d),0),T("#elevation-chart").width()-c);if(T(".elevation-profile-hover-card").css("left",f+"px"),S(u)<14?T(".elevation-profile-hover-card").css("top",p-l+"px"):T(".elevation-profile-hover-card").css("top","-3px"),T(".elevation-profile-hover-card .distance").text(C(n,!0)),T(".elevation-profile-hover-card .height").text(y.format(".0f")(u)+" m"),j.model.hasSourceGeometry()&&t){var h=Math.min(n/w.domain()[1],1),g=j.model.getSourceRoute().olFeature.getGeometry().getCoordinateAt(h);M.getGeometry().setCoordinates(g)}}if(j.model.hasSourceGeometry()){var L=function(e){var t=!1;(G.request("Map","getMap").forEachFeatureAtPixel(e.pixel,function(e){e===r.model.getSourceRoute().olFeature&&(t=!0)},{hitTolerance:14}),t)?(k(),z(Object(J.calculateRelativeDistance)(r.model.getSourceRoute().olFeature,e.coordinate)*a)):P();return!0};this.pointerListeners.push(L),G.trigger("Map","registerListener","pointermove",L)}h.append("rect").attr("class","chartOverlay").attr("width",a).attr("height",p).on("mouseover",function(){return k(!0)}).on("mouseout",P.bind(this)).on("mousemove",function(){z(Object(q.c)(this)[0],!0)}),h.transition().duration(300).ease(A.b).style("opacity",1)},getThemeColor:function(){var e=this.getThemeColorString();return[].concat(X(e.split("(")[1].split(")")[0].split(",").map(function(e){return Number(e)})),[1])},getThemeColorString:function(){return T("#elevation-profile .info-bar").css("background-color")}});s.default=a}.call(this,u(5),u(3),u(10),u(4),u(24))},1934:function(e,s,u){"use strict";u.r(s),function(e,t,r){var n=u(2098),i=u.n(n),o=u(1879),a=e.View.extend({model:null,template:t.template(i.a),events:{click:"onMinimizerClicked"},initialize:function(){this.listenTo(this.model,{"change:elevationResult":this.render,"change:isMinimized":this.render})},render:function(){var e=this.model.getElevationResult(),t=[];e&&e.hasNoError()&&(t=[{icon:"fa-arrow-up",titleI18nKey:"maxHeight",value:Object(o.distanceHumanized)(e.getMaxHeight())},{icon:"fa-arrow-down",titleI18nKey:"minHeight",value:Object(o.distanceHumanized)(e.getMinHeight())},{icon:"fa-arrows-alt-h",titleI18nKey:"distance",value:Object(o.distanceHumanized)(e.getDistance())}]);var n={infos:t,i18n:r.t("additional:elevationProfile",{returnObjects:!0}),isMinimized:this.model.isMinimized()};return this.$el.html(this.template(n)),this.delegateEvents(),this},onMinimizerClicked:function(){this.model.setMinimized(!this.model.isMinimized())}});s.default=a}.call(this,u(5),u(3),u(24))},2033:function(e,d,f){"use strict";f.r(d),function(e,t,r,n){var i=f(2125),o=f.n(i),a=f(1932),s=f(1933),u=f(1934),c=f(5),l=e.View.extend({model:null,template:t.template(o.a),infoBarView:null,chartView:null,transitionDuration:200,initialize:function(){var e=c.Radio.request("Parser","getPortalConfig"),t=e?e.elevationProfile:{};this.model=new a.default(t),this.infoBarView=new u.default({model:this.model}),this.chartView=new s.default({model:this.model}),r(window).on("resize",this.render.bind(this)),this.listenTo(this.model,{"change:isOpen":this.render,"change:isMinimized":this.render},this),this.listenTo(c.Radio.channel("i18next"),"languageChanged",this.render),this.listenTo(c.Radio.channel("Util"),"isViewMobileChanged",this.render)},destroy:function(){this.chartView.destroy(),this.getContainer().empty(),this.getContainer().css("border","0px solid lightgrey")},render:function(){var e=this.getContainer()[0];if(!e){var t=r("#map"),n="<div id='elevation-profile'></div>";t.length?t.append(n):r("body").append(n),e=this.getContainer()[0]}return this.setElement(e),c.Radio.request("Util","isViewMobile")||!this.model.isOpen()?this.destroy():this.renderContent(),this},renderContent:function(){var e=this,t={i18n:n.t("additional:elevationProfile",{returnObjects:!0})};this.$el.html(this.template(t)),this.$("#info-bar").html(this.infoBarView.render().el),this.getContainer().css("border","2px solid lightgrey"),this.model.isMinimized()?(this.getContainer().addClass("minimized"),this.getInfoContainer().addClass("hidden"),this.getContainer().css("right",""),this.chartView.destroy()):(this.getContainer().removeClass("minimized"),this.getInfoContainer().removeClass("hidden"),this.getContainer().css("right","30%"),setTimeout(function(){return e.chartView.render()},this.transitionDuration))},getContainer:function(){return r("#elevation-profile")},getInfoContainer:function(){return r(".info-container")}});d.default=l}.call(this,f(5),f(3),f(10),f(24))},2097:function(e,t){e.exports='<div class="status-container">\r\n    <div class="status-box">\r\n        <% if (hasError) { %>\r\n            <i class="status-icon error fas fa-exclamation-triangle"></i>\r\n        <% } %>\r\n        <% if (isLoading) { %>\r\n            <i class="status-icon fas fa-spinner fa-spin"></i>\r\n        <% } %>\r\n        <div class="status-message"><%= statusMessage %></i>\r\n    </div>\r\n</div>\r\n'},2098:function(e,t){e.exports='<div class="info-bar">\r\n    <span class="fas fa-caret-down fa-lg" id="info-bar-minimizer" title="<%= isMinimized ? i18n.maximize : i18n.minimize %>"></span>\r\n    <div class="info-bar-title">\r\n        <i class="fas fa-chart-area"></i>\r\n        <%= i18n.elevationProfile %>\r\n    </div>\r\n    <% if (!isMinimized) { %>\r\n        <div class="info-bar-entries">\r\n            <% _.each(infos, function(entry) { %>\r\n                <div class="info-bar-entry" title="<%= i18n[entry.titleI18nKey] %>">\r\n                    <i class="fas <%= entry.icon %>"></i>\r\n                    <span><%= entry.value %></span>\r\n                </div>\r\n            <% }); %>\r\n        </div>\r\n    <% } %>\r\n</div>'},2125:function(e,t){e.exports='<div id="info-bar"></div>\r\n<div id="elevation-chart-container">\r\n    <div id="elevation-chart"></div>    \r\n</div>\r\n<div class="info-container">\r\n    <%= i18n.elevationProfileInfo %>\r\n</div>\r\n'}}]);