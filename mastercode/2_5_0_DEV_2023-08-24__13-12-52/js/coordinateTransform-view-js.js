(window.webpackJsonp=window.webpackJsonp||[]).push([[165,164],{1916:function(e,i,s){"use strict";s.r(i),function(e,t,r){var n=s(18).a.extend({defaults:{currentLng:"",i18nDescription:"Geben Sie im linken unteren Feld Koordinaten ein, die transformiert werden sollen. Koordinaten werden mittels Komma getrennt, mehrere Paare mittels Semikolon.<br/>Bitte beachten Sie, dass in diesem Tool abweichend von der Norm stets zuerst die Länge (Ostwert) angegeben wird.",i18nCrsSource:"Quelle",i18nCrsTarget:"Ziel",i18nCrsPlaceHolder:"Bitte wählen...",i18nCoordinateInputPlaceHolder:"Koordinaten eingeben...&#10;Beispiel für EPSG:4326:&#10;13,52;&#10;13.9234,52.437",i18nResult:"Ergebnis",isActive:!1,renderToWindow:!0,sourceCrs:null,sourceCrsValid:!1,targetCrs:null,targetCrsValid:!1,sourceCoordinates:"",sourceCoordinatesValid:!1,targetCoordinates:"",loading:!1,id:"coordinateTransform",name:"Coordinate Transform",glyphicon:"glyphicon-record",availableSourceCrs:[],availableTargetCrs:[]},initialize:function(){this.superInitialize(),this.listenTo(this,{"change:sourceCrs":this.transform,"change:targetCrs":this.transform,"change:sourceCoordinates":e.debounce(this.transform,500)}),Config.coordinateTransformSourceCrs&&(this.set("availableSourceCrs",Config.coordinateTransformSourceCrs),this.set("sourceCrs",Config.coordinateTransformSourceCrs[0])),Config.coordinateTransformTargetCrs&&(this.set("availableTargetCrs",Config.coordinateTransformTargetCrs),this.set("targetCrs",Config.coordinateTransformTargetCrs[0])),this.listenTo(t.channel("i18next"),{languageChanged:this.changeLang})},fetchCrsInfo:function(e,t){var r=this,n="https://epsg.io/?q="+e.term+"&format=json";fetch(n).then(function(e){return e.json()}).then(function(e){return t(r.formatResponse(e))}).catch(function(e){return t(["Fehler bei der Abfrage: "+e])})},formatResponse:function(e){return e.results.map(function(e){return{label:"EPSG:"+e.code+", "+e.name,value:e.code}})},transform:function(){var r=this;if(this.isValid()){var e=this.get("sourceCoordinates");e.endsWith(";")&&(e=e.substring(0,e.length-1));var t="https://epsg.io/trans?data="+e+"&s_srs="+this.get("sourceCrs")+"&t_srs="+this.get("targetCrs");this.set("targetCoordinates",""),this.set("loading",!0),fetch(t).then(function(e){return e.json()}).then(function(e){var t=[];Array.isArray(e)?e.forEach(function(e){t.push(e.x+", "+e.y)}):t.push(e.x+", "+e.y),r.set("targetCoordinates",t.join("\n"))}).catch(function(){r.set("sourceCoordinatesValid",!1),r.set("targetCoordinates","")}).finally(function(){return r.set("loading",!1)})}},isValid:function(){var e=this.get("sourceCoordinates"),t=this.get("sourceCrs"),r=this.get("targetCrs"),n=!!(t&&0<t.length),i=!!(r&&0<r.length),s=e&&e.split&&e.split(";")[e.endsWith(";")?e.split(";").length-2:e.split(";").length-1],a=!(!(e&&2<e.length&&1<s.split(",").length&&""!==e.split(",")[e.split(",").length-1].trim())||s.endsWith(","));return this.set("sourceCrsValid",n),this.set("targetCrsValid",i),this.set("sourceCoordinatesValid",a),n&&i&&a},changeLang:function(e){this.set({i18nChooseCrsByTyping:r.t("additional:coordinateTransform.i18nChooseCrsByTyping"),i18nChooseCrsBySelecting:r.t("additional:coordinateTransform.i18nChooseCrsBySelecting"),i18nDescription:r.t("additional:coordinateTransform.i18nDescription"),i18nCrsSource:r.t("additional:coordinateTransform.i18nCrsSource"),i18nCrsTarget:r.t("additional:coordinateTransform.i18nCrsTarget"),i18nCrsPlaceHolder:r.t("additional:coordinateTransform.i18nCrsPlaceHolder"),i18nCoordinateInputPlaceHolder:r.t("additional:coordinateTransform.i18nCoordinateInputPlaceHolder"),i18nResult:r.t("additional:coordinateTransform.i18nResult"),currentLng:e})}});i.default=n}.call(this,s(3),s(4),s(24))},2029:function(e,d,l){"use strict";l.r(d),function(e,t,r,i){var n=l(2115),s=l.n(n),a=l(1916),o=(l(2116),l(2117),l(2120),l(308),e.View.extend({events:{"keyup .coordinate-input > textarea":"updateCoordinates"},initialize:function(){var e=t.request("ModelList","getModelByAttributes",{id:"coordinateTransform"}).attributes;this.model=new a.default(e),this.listenTo(this.model,{"change:isActive":this.render,"change:currentLng":function(){this.model.get("isActive")&&this.render()},"change:loading":this.updateLoadmask,"change:sourceCrsValid":this.showValidState,"change:targetCrsValid":this.showValidState,"change:sourceCoordinatesValid":this.showValidState,"change:targetCoordinates":this.updateTargetCoordinates})},template:r.template(s.a),render:function(e,t){var r=e.toJSON(),n=i(".coordinate-transform")[0];return n||(i("body").append("<div class='coordinate-transform'></div>"),n=i(".coordinate-transform")[0]),t&&(this.setElement(document.getElementsByClassName("win-body")[0]),this.$el.html(this.template(r)),0===r.availableSourceCrs.length?this.prepareCrsInput(i("#sourcecrs")):i("#sourcecrs").on("input",this.updateCrs.bind(this)),0===r.availableTargetCrs.length?this.prepareCrsInput(i("#targetcrs")):i("#targetcrs").on("input",this.updateCrs.bind(this)),this.showValidState()),this.renderSelect(),this},renderSelect:function(){var t=this;i(".selectpicker-coordinate-transform")&&(this.$(".selectpicker-coordinate-transform").selectpicker({styleBase:"btn",style:"btn-select",width:"120px"}),document.querySelectorAll(".selectpicker-coordinate-transform").forEach(function(e){e.addEventListener("change",t.updateCrs.bind(t))}))},prepareCrsInput:function(e){e&&e.autocomplete&&e.autocomplete({appendTo:".coordinate-transform",select:this.updateCrs.bind(this),delay:100,source:this.model.fetchCrsInfo.bind(this.model)})},updateCrs:function(e,t){var r=t&&t.item.value?t.item.value:e.target.value;"sourcecrs"===e.target.id?this.model.set("sourceCrs",r):this.model.set("targetCrs",r)},updateCoordinates:function(e){this.model.set("sourceCoordinates",e.target.value)},showValidState:function(){var e=this.$(".coordinate-input > #input"),t=this.$("input#sourcecrs"),r=this.$("input#targetcrs");this.model.get("sourceCrsValid")?t.removeClass("invalid",300):t.addClass("invalid",300),this.model.get("targetCrsValid")?r.removeClass("invalid",300):r.addClass("invalid",300),this.model.get("sourceCoordinatesValid")?e.removeClass("invalid",300):e.addClass("invalid",300)},updateTargetCoordinates:function(){this.$(".coordinate-output > textarea")[0].value=this.model.get("targetCoordinates")},updateLoadmask:function(e,t){var r=this.$(".coordinate-output > textarea");t?(r.addClass("coordinates-loading"),r[0].style.backgroundImage="url(../../img/ajax-loader.gif)"):(r.removeClass("coordinates-loading"),r[0].style.backgroundImage="unset")}}));d.default=o}.call(this,l(5),l(4),l(3),l(10))},2115:function(e,t){e.exports='<!DOCTYPE html>\r\n<div class="coordinate-transform">\r\n    <p>\r\n        <%= i18nDescription %>\r\n    </p>\r\n    <div class="coordinate-title-wrapper">\r\n        <div class="coordinate-source">\r\n            <%= i18nCrsSource %>:\r\n        </div>\r\n        <div class="coordinate-target">\r\n            <%= i18nCrsTarget %>:\r\n        </div>\r\n    </div>\r\n    <div class="coordinate-crs-wrapper">\r\n            <div class="ui-widget">\r\n                <% if (availableSourceCrs.length > 0) { %>\r\n                    <select id="sourcecrs" placeholder="<%= i18nCrsPlaceHolder %>" class="selectpicker-coordinate-transform">\r\n                        <% _.each(availableSourceCrs, function (crs) { %>\r\n                            <option value=<%= crs %>>EPSG:<%= crs %></option>\r\n                        <% }); %>\r\n                    </select>\r\n                <% } else { %>\r\n                    <input id="sourcecrs" placeholder="<%= i18nCrsPlaceHolder %>"/>\r\n                <% } %>\r\n            </div>\r\n            <div class="ui-widget">\r\n                <% if (availableTargetCrs.length > 0) { %>\r\n                    <select id="targetcrs" placeholder="<%= i18nCrsPlaceHolder %>" class="selectpicker-coordinate-transform">\r\n                        <% _.each(availableTargetCrs, function (crs) { %>\r\n                            <option value=<%= crs %>>EPSG:<%= crs %></option>\r\n                        <% }); %>\r\n                    </select>\r\n                <% } else { %>\r\n                    <input id="targetcrs" placeholder="<%= i18nCrsPlaceHolder %>"/>\r\n                <% } %>\r\n            </div>\r\n    </div>\r\n    <div class="coordinate-wrapper">\r\n        <div class="coordinate-input">\r\n            <textarea id="input" rows="5" cols="20" placeholder="<%= i18nCoordinateInputPlaceHolder %>"></textarea>\r\n        </div>\r\n        <div class="coordinate-output">\r\n            <textarea readonly id="output" rows="5" cols="20" placeholder="<%= i18nResult %>"></textarea>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},2116:function(e,t,r){}}]);