(window.webpackJsonp=window.webpackJsonp||[]).push([[182],{1871:function(e,o,i){"use strict";i.r(o),function(e,a,T){var R=i(471),w=i(5),M=i(100),F=i(23),b=i(34),S=i(37),C=i(113);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var t=e.Model.extend({defaults:{searchResultFooterDownloadTitle:"Herunterladen",searchResultFooterRoutingTitle:"Routenplaner",searchResultFooterMapTitle:"Karte",searchResultFooterMapToolTip:"Zur Karte hinzufügen",searchResultFooterCapabilitiesTitle:"Capabilities",searchResultFooterMetadataTitle:"Informationen",searchResultFooterMetadataToolTip:"Informationen öffnen",staticTypeDescription:"Typ",id:void 0,title:void 0,description:void 0,category:void 0,category_label:void 0,type:void 0,type_label:void 0,geometry:void 0,additionalData:void 0,thumbnail:void 0,glyphIcon:void 0,glyphIcons:void 0,overlayId:"search-result-overlay"},initialize:function(){var e=w.Radio.request("Parser","getPortalConfig"),t=e?e.detailedSearch:{};this.showLabelOnMap=t.showLabelOnMap,this.changeLang(a.language),this.listenTo(w.Radio.channel("i18next"),{languageChanged:this.changeLang}),w.Radio.request("Map","registerListener","singleclick",this.hideOverlay.bind(this))},getTransformedGeometry:function(){var e=this.get("geometry");this.get("geometryComplex")&&(e=this.get("geometryComplex"));var t=new R.a,a=w.Radio.request("MapView","getProjection"),o=a?a.getCode():void 0,i=o?t.readFeature(e,{dataProjection:"EPSG:4326",featureProjection:o}):void 0;return i?t.writeFeature(i):""},getTransformedExtent:function(){var e=this.getTransformedGeometry(),t=new R.a,a=e?t.readFeature(e):void 0,o=a?a.getGeometry():void 0;return o?o.getExtent():void 0},getOverlayPosition:function(e){var t=(e[2]-e[0])/2,a=(e[3]-e[1])/2,o=e[3]-a;return[e[2]-t,o]},getMapImport:function(e,t,a,o){var i;return r(i={isActive:!0,importType:e.toLowerCase()},e.toLowerCase(),t),r(i,"uuid",a),r(i,"metadataUrl",o),r(i,"wizzardStep",3),i},getMapExport:function(e,t){return{isActive:!0,wfsConfig:{url:e,version:t},wizzardStep:2}},changeLang:function(){this.set({searchResultFooterDownloadTitle:a.t("additional:detailedSearch.searchResultFooterDownloadTitle"),searchResultFooterRoutingTitle:a.t("additional:detailedSearch.searchResultFooterRoutingTitle"),searchResultFooterMapTitle:a.t("additional:detailedSearch.searchResultFooterMapTitle"),searchResultFooterMapToolTip:a.t("additional:detailedSearch.searchResultFooterMapToolTip"),searchResultFooterCapabilitiesTitle:a.t("additional:detailedSearch.searchResultFooterCapabilitiesTitle"),searchResultFooterMetadataTitle:a.t("additional:detailedSearch.searchResultFooterMetadataTitle"),searchResultFooterMetadataToolTip:a.t("additional:detailedSearch.searchResultFooterMetadataToolTip")},{silent:!0})},isRoutable:function(){var e=(new R.a).readGeometry(this.getTransformedGeometry()),t=null==e?void 0:e.getType();return void 0!==w.Radio.request("RoutingLGB","getSettings")&&("Point"===t||"plz"===this.get("type"))},openRouting:function(){var e=(new R.a).readGeometry(this.getTransformedGeometry()),t=e.getType();w.Radio.trigger("RoutingLGB","open",{waypoint:{coordinates:"Point"===t?e.getCoordinates():null,text:"Point"!==t?this.get("title"):null}}),w.Radio.trigger("DetailedSearch","setDetailedSearchVisible",!1)},showResultMap:function(){var e,t,a=this.getTransformedExtent(),o=(new R.a).readGeometry(this.getTransformedGeometry()),i=w.Radio.request("Map","getMap").getLayers().getArray(),r=i.find(function(e){return"mapMarker"===e.get("name")}),n=document.querySelector("#detailedSearchForm .btn-search-help"),l=i.find(function(e){return"markerAsPointLayer"===e.get("name")}),s=w.Radio.request("Map","getMap"),d=s.getOverlayById(this.get("overlayId"));if(s.removeOverlay(d),o){t="Point"===o.getType()?(e=l,o.getCoordinates()):(e=r,this.getOverlayPosition(a)),w.Radio.trigger("MapMarker","showWktFeature",this.getTransformedGeometry());var u=[255,0,0,1],p=[255,0,0,.3];if(n&&(u=window.getComputedStyle(n).color.split("(")[1].split(")")[0].split(","),p=window.getComputedStyle(n).color.split("(")[1].split(")")[0].split(","),u.push("1"),p.push("0.3")),e){var c=T("<a>",{href:"#",class:"ol-popup-closer"}),g='<div class="ol-popup-title">'+this.get("title")+"</div>",h='<div class="ol-popup-body">'+this.get("additionalData").subtitle+"</div>",v=T("<div>",{class:"ol-popup"});v.append(c),v.append(g),this.get("additionalData").subtitle&&v.append(h);var y=new M.a({id:this.get("overlayId"),element:v[0],offset:[0,-12],position:t});c.on("click",function(){return s.removeOverlay(y),!1}),this.showLabelOnMap&&s.addOverlay(y);var f=new F.c({stroke:new b.a({color:u,lineDash:[8],width:4}),fill:new S.a({color:p})}),m=new F.c({text:new C.a({text:"",font:"4em Glyphicons Halflings",fill:new S.a({color:u})})});"Point"===o.getType()?e.setStyle([f,m]):e.setStyle(f)}a&&w.Radio.trigger("Map","zoomToExtent",a)}},hideOverlay:function(){w.Radio.trigger("Map","removeOverlay",w.Radio.request("Map","getOverlayById",this.get("overlayId")))}});o.default=t}.call(this,i(5),i(24),i(10))}}]);