(window.webpackJsonp=window.webpackJsonp||[]).push([[9,215,216,217],{1936:function(e,r,t){"use strict";t.r(r),function(e){var t=e.Model.extend({defaults:{current:0,features:[],statusTitle:"",callIdTitle:"",changeInformationTitle:""},decrementCurrent:function(){var e=this.get("current");this.set("current",e-1)},incrementCurrent:function(){var e=this.get("current");this.set("current",e+1)}});r.default=t}.call(this,t(5))},1937:function(e,s,u){"use strict";u.r(s),function(e,t){var r=u(2099),a=u.n(r);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n=e.View.extend({events:{"click .geomaerker-feature-prev":"onFeaturePrevClick","click .geomaerker-feature-next":"onFeatureNextClick"},initialize:function(e){this.options=e,this.listenTo(this.model,{"change:current":this.render.bind(this)})},id:"geomaerker-popup",template:t.template(a.a),render:function(){var e=this.model.toJSON();return this.$el.html(this.template(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach(function(e){i(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},e))),this},onPageClick:function(){if(this.options.onPageClick){var e=this.model.get("current");this.options.onPageClick(e)}},onFeaturePrevClick:function(e){e.stopPropagation(),this.model.decrementCurrent(),this.onPageClick()},onFeatureNextClick:function(e){e.stopPropagation(),this.model.incrementCurrent(),this.onPageClick()}});s.default=n}.call(this,u(5),u(3))},1938:function(e,v,F){"use strict";F.r(v),function(e,o){F.d(v,"getReportMarkerColor",function(){return f}),F.d(v,"getReportMarkerStyle",function(){return h}),F.d(v,"getReportPolygonStyle",function(){return p}),F.d(v,"getReportPolygonEditStyle",function(){return t}),F.d(v,"clusterStyle",function(){return m});var i=F(43),n=F(81),s=F(41),r=F(37),a=F(34),u=F(23),l=F(113),c=F(188),d=F(123),g=F(36);function f(e){switch(e.get("status")){case"ungeprueft":return"#FF8080";case"geprueft":case"uebergeben":case"zurueckgestellt":case"vorbereitet":case"eingearbeitet":return"#FF9955";case"erledigt":return"#8DD35F";case"festgelegt":return"#65A3FF";case"archiviert":return"#CCCCCC";case"abgelehnt":return"#969696";case"geloescht":return"#646464";default:return"white"}}function h(e,t){return new u.c({text:new l.a({text:"",font:"4em Glyphicons Halflings",offsetX:0,offsetY:-20,fill:new r.a({color:f(e)}),scale:t,stroke:new a.a({color:"black",width:2})})})}function p(e){return new u.c({stroke:new a.a({color:f(e),width:2}),fill:new r.a({color:f(e)+"80"})})}function t(e){var t=f(e);return new u.c({stroke:new a.a({color:t,width:4}),fill:new r.a({color:t+"80"})})}function m(e){return[new u.c({text:new l.a({text:"",font:"900 4em 'Font Awesome 5 Free'",offsetX:0,offsetY:-15,fill:new r.a({color:"#FF9955"}),stroke:new a.a({color:"black",width:2})})}),new u.c({text:new l.a({text:e.toString(),offsetX:0,offsetY:-20,font:"'MasterPortalFont', 'Arial Narrow', Arial, sans-serif",fill:new r.a({color:"black"})})})]}var y=e.Model.extend({defaults:{nutzer_fehlermeldung:"",nutzer_name:"",nutzer_email:"",nutzer_institution:"",nutzer_telefon:"",nutzer_url:"",the_geom:"",privacyAgreement:!1,saveFeatureSuccessDescription:"",saveFeatureErrorDescription:"",fetchFeaturesErrorDescription:"",urlEndpoint:"",apiAuthUser:"",apiAuthPassword:"",public:!0,max_mitteilung_length:1e3,max_vertices:100},url:function(){return this.get("public")?this.get("urlEndpoint"):this.get("urlEndpoint")+"private"},postUrl:function(){return this.get("urlEndpoint")},validate:function(){var e=[],t=this.get("the_geom").geometry.coordinates[0][0].length-1,r=this.get("nutzer_fehlermeldung"),a=/^[0-9a-zA-ZäüöÄÜÖß ,.:\-\n\r?]+$/;return r||e.push("description"),this.get("privacyAgreement")||e.push("privacyAgreement"),this.get("nutzer_email")&&!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(this.get("nutzer_email"))&&e.push("nutzer_email"),t>this.get("max_vertices")&&e.push("the_geom"),r&&r.length>this.get("max_mitteilung_length")&&e.push("descriptionlength"),r&&!a.test(r)&&e.push("descriptioninvalid"),this.get("nutzer_name")&&!a.test(this.get("nutzer_name"))&&e.push("nameinvalid"),this.get("nutzer_institution")&&!a.test(this.get("nutzer_institution"))&&e.push("institutioninvalid"),this.get("nutzer_telefon")&&!/^[0-9-./+@ ]+$/.test(this.get("nutzer_telefon"))&&e.push("telefoninvalid"),e},setGeometry:function(e){this.set("geometry",e)},saveData:function(){var e=this.get("the_geom");e.properties={nutzer_fehlermeldung:this.get("nutzer_fehlermeldung"),nutzer_name:this.get("nutzer_name"),nutzer_email:this.get("nutzer_email"),nutzer_institution:this.get("nutzer_institution"),nutzer_telefon:this.get("nutzer_telefon"),nutzer_url:this.get("nutzer_url")};var t=this,r={"Content-Type":"application/json"};return!this.get("public")&&this.get("apiAuthUser")&&this.get("apiAuthPassword")&&(r.Authorization="Basic ".concat(btoa(this.get("apiAuthUser")+":"+this.get("apiAuthPassword")))),fetch(this.postUrl(),{method:"POST",body:JSON.stringify(e),headers:r}).then(function(e){return e.json()}).then(function(e){return o.trigger("Alert","alert",{text:t.get("saveFeatureSuccessDescription"),kategorie:"alert-success"}),window.setTimeout(function(){o.trigger("Alert","alert:remove")},3e3),e}).catch(function(){o.trigger("Alert","alert",{text:t.get("saveFeatureErrorDescription"),kategorie:"alert-danger"}),window.setTimeout(function(){o.trigger("Alert","alert:remove")},3e3)})},fetchReportFeatures:function(){var e={"Content-Type":"application/json"};return!this.get("public")&&this.get("apiAuthUser")&&this.get("apiAuthPassword")&&(e.Authorization="Basic ".concat(btoa(this.get("apiAuthUser")+":"+this.get("apiAuthPassword")))),fetch(this.url(),{method:"GET",headers:e}).then(function(e){return e.json()}).then(function(e){var t,r=new i.a({source:new c.a({distance:50,source:new s.a({features:(new n.a).readFeatures(e)})}),visible:!0,style:function(e){if(e.get("features")){var t=e.get("features").length;return 1===t?h(e.get("features")[0],1):m(t)}return h(e,1)},zIndex:1002});if(!this.get("public")){var a=[];(new n.a).readFeatures(e).forEach(function(e){a.push(new g.a({geometry:new d.a(e.get("the_geom").coordinates),fid:e.get("fid"),status:e.get("status")}))}),t=new i.a({source:new s.a({features:a}),visible:!0,renderMode:"image",maxResolution:o.request("Map","getMap").getView().getResolutionForZoom(4),style:function(e){return p(e)},zIndex:1001})}return{featurePoints:r,featurePolygons:t}}.bind(this)).catch(function(){o.trigger("Alert","alert",{text:this.get("fetchFeaturesErrorDescription"),kategorie:"alert-danger"})}.bind(this))}});v.default=y}.call(this,F(5),F(4))},1977:function(e,b,I){"use strict";I.r(b),function(r,g,u){I.d(b,"getReportStatusTranslation",function(){return F});var e=I(18),f=I(1938),a=I(47),o=I(295),t=I(362),l=I(100),i=I(171),n=I(146),s=I(81),c=I(1937),d=I(1936);function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach(function(e){m(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y={geometry:"MultiPolygon",geometryFunction:null,id:"drawPolygon"},v={geometry:"MultiPoint",geometryFunction:null,id:"drawPoint"};function F(e){switch(e.get("status")){case"ungeprueft":return r.t("additional:geoMaerker.feature.status.unaudited");case"geprueft":return r.t("additional:geoMaerker.feature.status.audited");case"uebergeben":return r.t("additional:geoMaerker.feature.status.handedOver");case"zurueckgestellt":return r.t("additional:geoMaerker.feature.status.returned");case"vorbereitet":return r.t("additional:geoMaerker.feature.status.prepared");case"eingearbeitet":return r.t("additional:geoMaerker.feature.status.incorporated");case"erledigt":return r.t("additional:geoMaerker.feature.status.done");case"festgelegt":return r.t("additional:geoMaerker.feature.status.set");case"archiviert":return r.t("additional:geoMaerker.feature.status.archived");case"abgelehnt":return r.t("additional:geoMaerker.feature.status.rejected");case"geloescht":return r.t("additional:geoMaerker.feature.status.removed");default:return r.t("additional:geoMaerker.feature.status.unknown")}}var w=e.a.extend({defaults:Object.assign({},e.a.prototype.defaults,{currentLng:"de",map:void 0,glyphicon:"fas fa-map-marked-alt fa-lg",id:"geoMaerker",deactivateGFI:!0,nameTranslationKey:"common:menu.tools.geoMaerker",zoomInteraction:void 0,drawInteraction:void 0,modifyInteraction:void 0,selectHoverOnFeaturesInteraction:void 0,selectClickOnFeaturesInteraction:void 0,selectHoverOnFeaturesListener:{},drawButtonDisabled:!0,addFeatureListener:{},pointerPosition:null,idCounter:0,drawnReportFeatureLayer:void 0,drawnReportFeature:void 0,reportFeaturesLayer:void 0,reportFeaturesWMSLayer:void 0,drawInteractionType:{geometry:"MultiPolygon",geometryFunction:null,id:"drawPolygon"},formVoluntaryInformationHelp:"",formDescriptionLabel:"",formDescriptionError:"",formDescriptionLengthError:"",formDescriptionInvalidError:"",formEmailError:"",formGeomError:"",formNameLabel:"",formNamePlaceholder:"",formNameInvalidError:"",formEmailLabel:"",formEmailPlaceholder:"",formInstitutionLabel:"",formInstitutionPlaceholder:"",formInstitutionInvalidError:"",formPhoneNumberLabel:"",formPhoneNumberPlaceholder:"",formPhoneNumberInvalidError:"",formPrivacyAgreementLabel:"",formPrivacyAgreementError:"",formPrivacyAgreementInfos:[],formCookieAgreementLabel:"",formCookieAgreementInfo:"",formButtonSubmit:"",formButtonCancel:"",fetchFeaturesErrorDescription:"",updateGeometryErrorDescription:"",editGeomInfoText:"",saveGeomLabel:"",cancelGeomLabel:"",editDrawingEdit:"",createDrawing:"",introText:"",helpLabel:"",geometryIsWrongMessage:"",changeInformationTitle:"",callIdTitle:"",statusTitle:"",tooManyLayersText:"",showFormDescriptionError:!1,showFormPrivacyAgreementError:!1,showFormEmailError:!1,testGeometryFailedDescription:"",showEditDrawnReportButton:!g.request("Util","isViewMobile"),selectedFeature:void 0,selectedFeatures:void 0,wmsBaseUrl:"",wmsVersion:"",wmsLayer:"",apiEndpoint:"",apiAuthUser:"",apiAuthPassword:"",reportFeaturesGeometryLayer:void 0,public:!0,selectFeaturesGeometryInteraction:void 0,doubleClickZoomInteraction:void 0,modifiedFeature:void 0,orignalFeature:void 0,type:"tool",parentId:"root",clusterSource:void 0,adminEditGeometryActive:!1,showPrivacyInfo:!1,showCookieInfo:!1,hoverOverlayId:"geomaerker-info-overlay",clickOverlayId:"geomaerker-info-overlay-clicked",cookieData:{},max_mitteilung_length:1e3,max_name_length:100,max_institution_length:100,max_email_length:50,max_telefon_length:50,max_vertices:100,max_layers_possible:100}),initialize:function(){this.superInitialize();var e=this.get("apiEndpoint")+"reports/";this.reportModel=new f.default({urlEndpoint:e,public:this.get("public"),apiAuthUser:this.get("apiAuthUser"),apiAuthPassword:this.get("apiAuthPassword"),max_mitteilung_length:this.get("max_mitteilung_length"),max_vertices:this.get("max_vertices")}),this.listenTo(g.channel("MapView"),{changedZoomLevel:this.onZoomLevelChange}),this.listenTo(g.channel("i18next"),{languageChanged:this.changeLang}),this.changeLang(r.language),this.listenTo(this,{"change:isActive":function(){this.createReportFeaturesLayer(),this.get("public")&&this.createReportFeaturesWMSLayer()},"change:reportFeaturesLayer":this.updateReportFeaturesLayerInteractions,"change:reportFeaturesGeometryLayer":this.updateReportFeaturesGeometryLayerInteraction,"change:adminEditGeometryActive":this.onAdminEditGeometryActiveChange}),g.request("Util","isViewMobile")?this.setDrawInteractionType(v):this.setDrawInteractionType(y);var t=g.request("MapView","getZoomLevel");this.onZoomLevelChange(t)},changeLang:function(e){this.set({currentLng:e,formVoluntaryInformationHelp:r.t("additional:geoMaerker.form.voluntaryInformation"),formDescriptionLabel:r.t("additional:geoMaerker.form.description.label"),formDescriptionError:r.t("additional:geoMaerker.form.description.error"),formDescriptionLengthError:r.t("additional:geoMaerker.form.description.lengthError",{max_mitteilung_length:this.get("max_mitteilung_length")}),formDescriptionInvalidError:r.t("additional:geoMaerker.form.description.invalidError"),formEmailError:r.t("additional:geoMaerker.form.email.error"),formGeomError:r.t("additional:geoMaerker.form.geom.error",{max_vertices:this.get("max_vertices")}),formNameLabel:r.t("additional:geoMaerker.form.name.label"),formNamePlaceholder:r.t("additional:geoMaerker.form.name.placeholder"),formNameInvalidError:r.t("additional:geoMaerker.form.name.invalidError"),formEmailLabel:r.t("additional:geoMaerker.form.email.label"),formEmailPlaceholder:r.t("additional:geoMaerker.form.email.placeholder"),formInstitutionLabel:r.t("additional:geoMaerker.form.institution.label"),formInstitutionPlaceholder:r.t("additional:geoMaerker.form.institution.placeholder"),formInstitutionInvalidError:r.t("additional:geoMaerker.form.institution.invalidError"),formPhoneNumberLabel:r.t("additional:geoMaerker.form.phoneNumber.label"),formPhoneNumberPlaceholder:r.t("additional:geoMaerker.form.phoneNumber.placeholder"),formPhoneNumberInvalidError:r.t("additional:geoMaerker.form.phoneNumber.invalidError"),formPrivacyAgreementLabel:r.t("additional:geoMaerker.form.privacyAgreement.label"),formPrivacyAgreementError:r.t("additional:geoMaerker.form.privacyAgreement.error"),formPrivacyAgreementInfos:r.t("additional:geoMaerker.form.privacyAgreement.infos",{returnObjects:!0}),formCookieAgreementLabel:r.t("additional:geoMaerker.form.cookieAgreement.label"),formCookieAgreementInfo:r.t("additional:geoMaerker.form.cookieAgreement.info"),formButtonSubmit:r.t("additional:geoMaerker.form.buttons.submit"),formButtonCancel:r.t("additional:geoMaerker.form.buttons.cancel"),editGeomInfoText:r.t("additional:geoMaerker.form.editGeom.info"),saveGeomLabel:r.t("additional:geoMaerker.form.editGeom.save"),cancelGeomLabel:r.t("additional:geoMaerker.form.editGeom.cancel"),editDrawingEdit:r.t("additional:geoMaerker.editDrawing.edit"),createDrawing:r.t("additional:geoMaerker.createDrawing.create"),introText:r.t("additional:geoMaerker.introText"),helpLabel:r.t("additional:geoMaerker.helpLabel"),geometryIsWrongTitle:r.t("additional:geoMaerker.geometryIsWrong.title"),geometryIsWrongMessage:r.t("additional:geoMaerker.geometryIsWrong.message"),testGeometryFailedDescription:r.t("additional:geoMaerker.geometryIsWrong.message"),fetchFeaturesErrorDescription:r.t("additional:geoMaerker.reportModel.fetchFeatures.error.description"),updateGeometryErrorDescription:r.t("additional:geoMaerker.updateGeometryErrorDescription"),editGeometryBtnText:r.t("additional:geoMaerker.editGeometryBtnText"),changeInformationTitle:r.t("additional:geoMaerker.popup.changeInformationTitle"),callIdTitle:r.t("additional:geoMaerker.popup.callIdTitle"),statusTitle:r.t("additional:geoMaerker.popup.statusTitle"),tooManyLayersText:r.t("additional:geoMaerker.tooManyLayersText")}),this.reportModel.set({saveFeatureSuccessDescription:r.t("additional:geoMaerker.reportModel.saveFeature.success.description"),saveFeatureErrorDescription:r.t("additional:geoMaerker.reportModel.saveFeature.error.description"),fetchFeaturesErrorDescription:r.t("additional:geoMaerker.reportModel.fetchFeatures.error.description")})},onZoomLevelChange:function(e){var t=e<5,r=this.getSourceForZoom(e);this.set({drawButtonDisabled:t}),this.updateClusterSourceIfNeeded(r)},setDrawnReportFeatureLayer:function(e){this.set("drawnReportFeatureLayer",e)},setDrawnReportFeature:function(e){this.set("drawnReportFeature",e)},setAddFeatureListener:function(e){this.set("addFeatureListener",e)},setIdCounter:function(e){this.set("idCounter",e)},setDrawInteraction:function(e){this.set("drawInteraction",e)},setModifyInteraction:function(e){this.set("modifyInteraction",e)},setDrawInteractionType:function(e){this.set("drawInteractionType",e)},setReportFeaturesLayer:function(e){this.set("reportFeaturesLayer",e)},setSelectHoverOnFeaturesListener:function(e){this.set("selectHoverOnFeaturesListener",e)},setSelectHoverOnFeaturesInteraction:function(e){this.set("selectHoverOnFeaturesInteraction",e)},setSelectClickOnFeaturesInteraction:function(e){this.set("selectClickOnFeaturesInteraction",e)},setSelectedFeature:function(e){this.set("selectedFeature",e)},setSelectedFeatures:function(e){this.set("selectedFeatures",e)},setReportFeaturesWMSLayer:function(e){this.set("reportFeaturesWMSLayer",e)},setReportFeaturesGeometryLayer:function(e){this.set("reportFeaturesGeometryLayer",e)},setSelectFeaturesGeometryInteraction:function(e){this.set("selectFeaturesGeometryInteraction",e)},setModifiedFeature:function(e){this.set("modifiedFeature",e)},setOriginalFeature:function(e){this.set("originalFeature",e)},setDoubleClickZoomInteraction:function(e){this.set("doubleClickZoomInteraction",e)},setShowPrivacyInfo:function(e){this.set("showPrivacyInfo",e)},setShowCookieInfo:function(e){this.set("showCookieInfo",e)},createReportFeaturesWMSLayer:function(){if(this.get("isActive"))if(this.get("reportFeaturesWMSLayer"))g.trigger("Map","addLayer",this.get("reportFeaturesWMSLayer"));else{var e=new i.a({url:this.get("wmsBaseUrl"),params:{LAYERS:this.get("wmsLayer"),VERSION:this.get("wmsVersion"),FORMAT:"image/png",TRANSPARENT:!0},serverType:"geoserver"}),t=new n.a({source:e,title:"wms_report_feature_geometries",visible:!0,zIndex:999});this.setReportFeaturesWMSLayer(t),g.trigger("Map","addLayer",t)}else g.trigger("Map","removeLayer",this.get("reportFeaturesWMSLayer"))},createReportFeaturesLayer:function(){var a=this;this.get("isActive")?this.get("reportFeaturesLayer")&&(this.get("reportFeaturesGeometryLayer")||this.get("public"))?(this.get("reportFeaturesLayer")&&g.trigger("Map","addLayer",this.get("reportFeaturesLayer")),this.get("reportFeaturesGeometryLayer")&&!this.get("public")&&g.trigger("Map","addLayer",this.get("reportFeaturesGeometryLayer"))):this.reportModel.fetchReportFeatures().then(function(e){if(e){var t=e.featurePoints,r=e.featurePolygons;t&&(a.setClusterSource(t.getSource()),a.setReportFeaturesLayer(t),g.trigger("Map","addLayer",t)),r&&(a.setReportFeaturesGeometryLayer(r),g.trigger("Map","addLayer",r))}}).catch(function(){g.trigger("Alert","alert",{text:a.get("fetchFeaturesErrorDescription"),kategorie:"alert-danger"}),window.setTimeout(function(){g.trigger("Alert","alert:remove")},3e3)}):(this.get("reportFeaturesLayer")&&g.trigger("Map","removeLayer",this.get("reportFeaturesLayer")),this.get("reportFeaturesGeometryLayer")&&g.trigger("Map","removeLayer",this.get("reportFeaturesGeometryLayer")))},updateReportFeaturesLayerInteractions:function(){this.get("isActive")?this.addReportFeaturesLayerInteractions():this.removeReportFeaturesLayerInteractions()},addReportFeaturesLayerInteractions:function(){var e=this.createSelectFeatureInteraction(a.d,!0),t=this.createSelectFeatureInteraction(a.k);this.setSelectHoverOnFeaturesInteraction(t),this.setSelectClickOnFeaturesInteraction(e),this.createSelectFeatureInteractionListener(t),this.createSelectFeatureInteractionListener(e),g.trigger("Map","addInteraction",t),g.trigger("Map","addInteraction",e)},removeReportFeaturesLayerInteractions:function(){var e=this.get("selectHoverOnFeaturesInteraction"),t=this.get("selectClickOnFeaturesInteraction");g.trigger("Map","removeInteraction",e),g.trigger("Map","removeInteraction",t),this.setSelectHoverOnFeaturesInteraction(void 0),this.setSelectClickOnFeaturesInteraction(void 0)},createSelectFeatureInteraction:function(e,t){var r=1<arguments.length&&void 0!==t&&t;return new o.a({condition:e,style:function(e){return e.get("features")?Object(f.getReportMarkerStyle)(e.get("features")[0],1.5):Object(f.getReportMarkerStyle)(e,1.5)},layers:[this.get("reportFeaturesLayer")],multi:r,hitTolerance:10,filter:function(e){return!e.get("features")||1===e.get("features").length}})},onClickFeatureInteraction:function(e,t,r){var a=this.get("clickOverlayId"),o=this.get("hoverOverlayId"),i=g.request("Map","getMap"),n=i.getOverlayById(o),s=i.getOverlayById(a);n&&i.removeOverlay(n),s&&i.removeOverlay(s);var u=t[0];if(r&&r.forEach(function(e){e.setStyle(null)}),u!==this.get("selectedFeature")){var l=e.mapBrowserEvent.coordinate;if(!u)return void this.setSelectedFeature(void 0);this.createPopupOverlay(t,l,a)}this.setSelectedFeature(u),this.setSelectedFeatures(t)},onHoverFeatureInteraction:function(e,t,r){var a=t[0],o=r[0],i=this.get("selectedFeatures"),n=i&&i.includes(o);o&&this.get("selectedFeature")&&n&&(o.get("features")?o.setStyle(Object(f.getReportMarkerStyle)(o.get("features")[0],1.5)):o.setStyle(Object(f.getReportMarkerStyle)(o,1.5)));var s=this.get("hoverOverlayId"),u=g.request("Map","getMap"),l=u.getOverlayById(s);if(l&&u.removeOverlay(l),a!==this.get("selectedFeature")){var c=e.mapBrowserEvent.coordinate;if(!a)return;var d=a;a.get("features")&&(d=a.get("features")[0]),this.createPopupOverlay([d],c,s)}},createSelectFeatureInteractionListener:function(e){e.on("select",function(e){e.preventDefault();var t=e.selected,r=e.deselected;"click"===e.mapBrowserEvent.type?this.onClickFeatureInteraction(e,t,r):this.onHoverFeatureInteraction(e,t,r)}.bind(this))},createPopupOverlay:function(e,t,r){var a=document.createElement("div");if(a.id="geomaerker-info-overlay-popup",a.style.position="absolute",e.length){var o=e[0],i=new l.a({id:r,parentId:o.get("fid"),element:a});i.setPosition(t),g.request("Map","getMap").addOverlay(i);var n=this.getFeaturesInformation(e),s={placement:"auto",animation:!0,sanitize:!1,html:!0,content:this.createPopupContent(n)};u(a).popover(p(p({},s),{},{container:a})),u(a).popover("show"),u(".popover").css("max-width","unset"),u(".popover").find(".popover-title").remove(),u(".popover").find(".arrow").remove(),u(".popover").css("left","-165px"),u(".popover").css("padding","0"),u(".popover").css("border","unset"),u(".popover-content").css("padding","0")}},getFeaturesInformation:function(e){return e.map(function(e){var t=e;return e.get("features")&&(t=e.get("features")[0]),{fid:t.get("fid"),status:F(t),color:Object(f.getReportMarkerColor)(t),message:"ungeprueft"!==t.get("status")?t.get("erstpruefer_fehlermeldung"):r.t("additional:geoMaerker.feature.statusFullText.unaudited"),showDetailedInfo:"ungeprueft"!==t.get("status")&&"festgelegt"!==t.get("status"),showCallId:"festgelegt"!==t.get("status"),showCloseButton:!1,statusFullText:function(e){switch(e.get("status")){case"ungeprueft":return r.t("additional:geoMaerker.feature.statusFullText.unaudited");case"geprueft":return r.t("additional:geoMaerker.feature.statusFullText.audited");case"uebergeben":return r.t("additional:geoMaerker.feature.statusFullText.handedOver");case"zurueckgestellt":return r.t("additional:geoMaerker.feature.statusFullText.returned");case"vorbereitet":return r.t("additional:geoMaerker.feature.statusFullText.prepared");case"eingearbeitet":return r.t("additional:geoMaerker.feature.statusFullText.incorporated");case"erledigt":return r.t("additional:geoMaerker.feature.statusFullText.done");case"festgelegt":return r.t("additional:geoMaerker.feature.statusFullText.set");case"archiviert":return r.t("additional:geoMaerker.feature.statusFullText.archived");case"abgelehnt":return r.t("additional:geoMaerker.feature.statusFullText.rejected");case"geloescht":return r.t("additional:geoMaerker.feature.statusFullText.removed");default:return r.t("additional:geoMaerker.feature.statusFullText.unknown")}}(t)}})},createPopupContent:function(e){var t=new d.default({features:e,changeInformationTitle:this.get("changeInformationTitle"),callIdTitle:this.get("callIdTitle"),statusTitle:this.get("statusTitle")});return new c.default({model:t,onPageClick:this.onTooltipPageClick.bind(this)}).render().el},onTooltipPageClick:function(e){var t=this.get("selectedFeatures");if(t){var r=t[e];this.setSelectedFeature(r)}},createSelectFeatureGeometryInteraction:function(){return new o.a({condition:a.d,layers:[this.get("reportFeaturesGeometryLayer")],style:function(e){return Object(f.getReportPolygonEditStyle)(e)}})},createSelectFeatureGeometryInteractionListener:function(e){e.on("select",function(e){var t=this.get("originalFeature");0<e.deselected.length&&t&&e.deselected[0].setGeometry(t.getGeometry().clone()),0<e.selected.length?this.setOriginalFeature(e.selected[0].clone()):this.setOriginalFeature(void 0),this.setModifiedFeature(void 0)}.bind(this))},createModifyFeatureGeometryInteraction:function(e){return new t.a({features:e.getFeatures()})},createModifyFeatureGeometryInteractionListener:function(e){e.on("modifyend",function(e){this.setModifiedFeature(e.features.getArray()[0])}.bind(this))},addReportFeaturesGeometryLayerInteraction:function(){var e=this.createSelectFeatureGeometryInteraction(),t=this.createModifyFeatureGeometryInteraction(e);e.setActive(!1),this.createModifyFeatureGeometryInteractionListener(t),this.createSelectFeatureGeometryInteractionListener(e),this.setSelectFeaturesGeometryInteraction(e),g.trigger("Map","addInteraction",e),g.trigger("Map","addInteraction",t)},removeReportFeaturesGeometryLayerInteraction:function(){this.cancelGeometryEdit(),g.trigger("Map","removeInteraction",this.get("selectFeaturesGeometryInteraction")),g.trigger("Map","removeInteraction",this.get("modifyFeaturesGeometryInteraction"))},updateReportFeaturesGeometryLayerInteraction:function(){this.get("isActive")?this.addReportFeaturesGeometryLayerInteraction():this.removeReportFeaturesGeometryLayerInteraction()},updateGeometry:function(){var e=this.get("modifiedFeature"),t=this.get("apiEndpoint")+"reports/"+e.get("fid"),r=encodeURI(t),a={"Content-Type":"application/json"};!this.get("public")&&this.get("apiAuthUser")&&this.get("apiAuthPassword")&&(a.Authorization="Basic ".concat(btoa(this.get("apiAuthUser")+":"+this.get("apiAuthPassword"))));var o=(new s.a).writeFeature(e);fetch(r,{method:"POST",headers:a,body:o}).then(function(e){e.ok||(g.trigger("Alert","alert",{text:this.get("updateGeometryErrorDescription"),kategorie:"alert-danger"}),window.setTimeout(function(){g.trigger("Alert","alert:remove")},3e3)),this.deselectSelectedFeature(),this.setAdminEditGeometryActive(!1)}.bind(this)).catch(function(){g.trigger("Alert","alert",{text:this.get("updateGeometryErrorDescription"),kategorie:"alert-danger",fadeOut:1}),window.setTimeout(function(){g.trigger("Alert","alert:remove")},3e3),this.deselectSelectedFeature(),this.setAdminEditGeometryActive(!1)}.bind(this))},cancelGeometryEdit:function(){var e=this.get("modifiedFeature"),t=this.get("originalFeature");e&&t&&e.setGeometry(t.getGeometry()),this.deselectSelectedFeature(),this.setAdminEditGeometryActive(!1)},deselectSelectedFeature:function(){this.get("selectFeaturesGeometryInteraction").getFeatures().clear(),this.setOriginalFeature(void 0),this.setModifiedFeature(void 0)},getSourceForZoom:function(e){var t=g.request("Map","getMap").getView().getResolutions(),r=e===Math.floor(e),a=e===t.length-1,o=this.get("clusterSource");if(r&&o)return a&&(o=this.get("clusterSource").getSource()),o},updateClusterSourceIfNeeded:function(e){var t=this.get("reportFeaturesLayer");t&&e&&t.getSource()!==e&&t.setSource(e)},setClusterSource:function(e){this.set("clusterSource",e)},toggleAdminEditGeometryActive:function(){var e=this.get("adminEditGeometryActive");this.setAdminEditGeometryActive(!e)},setAdminEditGeometryActive:function(e){this.set("adminEditGeometryActive",e)},onAdminEditGeometryActiveChange:function(){this.get("adminEditGeometryActive")?(this.deactivateSelectMarkerInteraction(),this.activateSelectPolygonInteraction()):(this.cancelGeometryEdit(),this.deactivateSelectPolygonInteraction(),this.activateSelectMarkerInteraction())},activateSelectPolygonInteraction:function(){this.get("selectFeaturesGeometryInteraction").setActive(!0)},deactivateSelectPolygonInteraction:function(){this.get("selectFeaturesGeometryInteraction").setActive(!1)},activateSelectMarkerInteraction:function(){this.get("selectClickOnFeaturesInteraction").setActive(!0)},deactivateSelectMarkerInteraction:function(){this.get("selectClickOnFeaturesInteraction").setActive(!1)},toggleShowPrivacyInfo:function(){var e=this.get("showPrivacyInfo");this.setShowPrivacyInfo(!e)},toggleShowCookieInfo:function(){var e=this.get("showCookieInfo");this.setShowCookieInfo(!e)},setCookieData:function(e){this.set("cookieData",e)}});b.default=w}.call(this,I(24),I(4),I(10))},2099:function(e,t){e.exports='<!DOCTYPE html>\r\n<div>\r\n    <table\r\n        style="background-color:#E9F2FF; margin-left:0px; font-family:Verdana, Geneva, Arial, Helvetica, sans-serif; font-size:10pt; border-spacing: 0px;"\r\n        width="370px"\r\n    >\r\n        <tbody>\r\n            <tr style="background-color:<%= features[current].color %>; font-weight:bold; color:#FFFFFF" align="center">\r\n                <td style="padding:5px 0px;">\r\n                    <% if (features.length && current > 0) { %>\r\n                        <button class="geomaerker-feature-prev btn btn-default btn-xs" style="width:10%; float:left;">\r\n                            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>\r\n                        </button>\r\n                    <% } %>\r\n                    <div style="width:80%; float:left;">\r\n                        <%= features[current].status %>\r\n                    </div>\r\n                    <% if (features.length && current < features.length - 1) { %>\r\n                        <button class="geomaerker-feature-next btn btn-default btn-xs" style="width:10%; float:right;">\r\n                            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>\r\n                        </button>\r\n                    <% } %>\r\n                    <% if (features[current].showCloseButton) { %>\r\n                        <div id="tooltip-persistent" style="width:10%; float:right;">\r\n                            X\r\n                        </div>\r\n                    <% } %>\r\n                </td>\r\n            </tr>\r\n            <% if (features[current].showCallId) { %>\r\n            <tr valign="top">\r\n                <td style="padding:7px 6px 3px;">\r\n                    <span style="color:#345B9A; font-weight:bold;">\r\n                        <%= callIdTitle %>:\r\n                    </span>\r\n                    <span style="margin-left: 10px">\r\n                        <%- features[current].fid %>\r\n                    </span>\r\n                </td>\r\n            </tr>\r\n            <% } %>\r\n            <% if (!features[current].showDetailedInfo) { %>\r\n                <tr style="color:#345B9A;" valign="top">\r\n                    <td style="color:#000000; padding:0px 6px 5px;">\r\n                        <%- features[current].message %>\r\n                    </td>\r\n                </tr>\r\n            <% } %>\r\n            <% if (features[current].showDetailedInfo) { %>\r\n            <tr style="color:#345B9A; font-weight:bold;" valign="top">\r\n                <td style="padding:9px 6px 3px;">\r\n                    <span>\r\n                        <%= changeInformationTitle %>:\r\n                    </span>\r\n                </td>\r\n            </tr>\r\n            <tr style="color:#345B9A;" valign="top">\r\n                <td style="color:#000000; padding:0px 6px;">\r\n                    <%- features[current].message %>\r\n                </td>\r\n            </tr>\r\n            <tr style="color:#345B9A; font-weight:bold;">\r\n                <td style="padding:9px 6px 3px;">\r\n                    <%= statusTitle %>:\r\n                </td>\r\n            </tr>\r\n            <tr style="color:#345B9A">\r\n                <td style="color:#000000; padding:0px 6px 5px;">\r\n                    <%- features[current].statusFullText %>\r\n                </td>\r\n            </tr>\r\n            <% } %>\r\n\r\n        </tbody>\r\n    </table>\r\n</div>\r\n'}}]);