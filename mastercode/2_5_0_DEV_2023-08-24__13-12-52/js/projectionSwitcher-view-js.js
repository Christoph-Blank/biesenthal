(window.webpackJsonp=window.webpackJsonp||[]).push([[243,242],{1946:function(e,s,u){"use strict";u.r(s),function(e){var R=u(8),a=u(1),n=u(257),c=u(258),i=u(38),S=u(189),M=u(414),v=u(170),C=u(337),j=u(187),b=u(41),l=u(77),y=u(5);function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var t=e.Model.extend({defaults:{selectedCrs:void 0,allowedCrs:[],parentSelector:"",scales:y.Radio.request("MapView","getScales"),asControl:!0,crsNameMapping:{}},initialize:function(){var e=y.Radio.request("MapView","getProjection"),t=e?e.getCode():void 0;t&&(this.set("selectedCrs",t),this.get("allowedCrs").some(function(e){return e===t})||this.set("allowedCrs",[t].concat(r(this.get("allowedCrs")))));this.get("allowedCrs").forEach(function(t){var e=Config.namedProjections.find(function(e){return e[0]===t});e?(i.default.defs(e[0],e[1]),Object(n.a)(i.default)):Object(R.h)(t)||console.warn("Could not find projection for "+t)})},transformSettingsCenter:function(e,t){var n=y.Radio.request("MapView","getSettingsCenter"),i=l.a.startCenter,r=n||i;if(r){var o=Object(R.n)(r,e,t);y.Radio.trigger("MapView","setSettingsCenter",o)}},transformSettingsExtent:function(e,t){var n,i=y.Radio.request("MapView","getSettingsExtent"),r=l.a.extent,o=i||r;if(o){var s=Object(R.j)(e,t);n=Object(a.a)(o,s),y.Radio.trigger("MapView","setSettingsExtent",n)}return n},transformSettingsResolution:function(e,t){var n,i=y.Radio.request("MapView","getSettingsResolution"),r=l.a.startResolution,o=i||r;if(o){var s=y.Radio.request("Map","getScaleForResolution",o,e.getUnits());n=y.Radio.request("Map","getResolutionForScale",s,t.getUnits()),y.Radio.trigger("MapView","setSettingsResolution",n)}},updateMapViewOptions:function(n){var e=y.Radio.request("MapView","getRawOptions");e.forEach(function(e,t){e.resolution=n[t]}),y.Radio.trigger("MapView","setOptions",e)},onProjectionChange:function(e){var f=Object(R.h)(e),p=Object(R.h)(this.get("selectedCrs")),h=this.transformSettingsExtent(p,f),t=y.Radio.request("Map","getMap"),n=t.getView(),i=y.Radio.request("MapView","getCenter"),r=Object(R.n)(i,p,f),o=n.getZoom(),w=this.get("scales").map(function(e){return y.Radio.request("Map","getResolutionForScale",e,f.getUnits())},this),s=t.getLayers().getArray(),m=new c.a({resolutions:w,zoom:o,extent:h,center:r,projection:f});s.forEach(function(e){var t=e.getSource(),n=e.getMinResolution(),i=e.getMaxResolution();if(e instanceof S.a){if(t instanceof M.b&&!(t instanceof C.a)){var r=t.getTileGrid(),o=Object(R.n)(r.getOrigin(),p,f),s=new v.a({url:t.getUrls()[0],attributions:t.getAttributions(),gutter:t.getGutter(),params:t.getParams(),tileGrid:new j.a({origin:o,resolutions:w,tileSize:r.getTileSize()})});e.setSource(s)}}else t instanceof b.a&&(t.forEachFeature(function(e){e.getGeometry().transform(p,f)}),e.setExtent(h));if(0<n){var a=y.Radio.request("Map","getScaleForResolution",n,p.getUnits()),c=y.Radio.request("Map","getResolutionForScale",a,f.getUnits()),l=m.constrainResolution(c);e.setMinResolution(l)}if(i<1/0){var u=y.Radio.request("Map","getScaleForResolution",i,p.getUnits()),g=y.Radio.request("Map","getResolutionForScale",u,f.getUnits()),d=m.constrainResolution(g);e.setMaxResolution(d+d/100)}},this),this.transformSettingsCenter(p,f),this.transformSettingsResolution(p,f),this.updateMapViewOptions(w),y.Radio.trigger("MapView","setView",m),this.set("selectedCrs",e)}});s.default=t}.call(this,u(5))},2061:function(e,l,u){"use strict";u.r(l),function(e,r,t,o){var s=u(203),a=u(1946),n=u(2149),i=u.n(n),c=(u(308),e.View.extend({events:{change:"onChange"},initialize:function(e){var t,n=r.channel("ProjectionSwitcherView"),i=r.request("Parser","getPortalConfig");t=e||(i&&i.projectionSwitcher?i.projectionSwitcher:{}),this.model=new a.default(t),this.listenTo(this.model,{change:this.render}),n.reply({getView:function(){return this}},this),this.initialRender(),this.render()},tagName:"div",className:"projection-switcher col-md-2",template:t.template(i.a),initialRender:function(){var e=this.model.get("parentSelector"),t=o(e),n=0<t.length?t[0]:void 0;if(this.model.get("asControl")){var i=new s.a({element:this.el,target:n});r.trigger("Map","addControl",i)}else e&&n&&n.append(this.el);return this},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this.renderSelect(),this},renderSelect:function(){o(".selectpicker-projectionSwitcher")&&this.$(".selectpicker-projectionSwitcher").selectpicker({styleBase:"btn",style:"btn-select",width:"180px"})},onChange:function(e){this.model.onProjectionChange(e.target.value)}}));l.default=c}.call(this,u(5),u(4),u(3),u(10))},2149:function(e,t){e.exports='    <select class="selectpicker-projectionSwitcher dropup" data-dropup-auto="false">\r\n        <% allowedCrs.forEach(function (crs) { %>\r\n            <option value="<%= crs %>" <% if (crs === selectedCrs) print(\'selected\') %> ><%= crsNameMapping[crs] ? crsNameMapping[crs] : crs %></option>\r\n        <% }); %>\r\n    </select>\r\n'}}]);